!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("socket.io-client")):"function"==typeof define&&define.amd?define(["exports","socket.io-client"],e):e(t.create_room={},t.io)}(this,function(t,c){"use strict";c=c&&c.hasOwnProperty("default")?c.default:c;var Q="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function n(t,e){return t(e={exports:{}},e.exports),e.exports}var y=n(function(t,e){function n(t){return t.x*t.x+t.y*t.y}function r(t){return Math.sqrt(n(t))}function i(t,e){return{x:e.x-t.x,y:e.y-t.y}}Object.defineProperty(e,"__esModule",{value:!0}),e.GetTopLeft=function(t){return{x:t.x,y:t.y}},e.GetTopRight=function(t){return{x:t.x+t.w,y:t.y}},e.GetBottomLeft=function(t){return{x:t.x,y:t.y+t.h}},e.GetBottomRight=function(t){return{x:t.x+t.w,y:t.y+t.h}},e.Normalize=function(t){var e=r(t);1e-4<e&&(t.x/=e,t.y/=e)},e.VectorLengthSq=n,e.VectorLength=r,e.DistanceSq=function(t,e){return n(i(t,e))},e.Distance=function(t,e){return r(i(t,e))},e.DotProduct=function(t,e){return t.x*e.x+t.y*e.y},e.CrossProduct=function(t,e){return t.x*e.y-t.y*e.x},e.GetVector=i,e.ClampPoint=function(t,e,n){return{x:Math.max(e.x,Math.min(n.x,t.x)),y:Math.max(e.y,Math.min(n.y,t.y))}}});e(y);y.GetTopLeft,y.GetTopRight,y.GetBottomLeft,y.GetBottomRight,y.Normalize,y.VectorLengthSq,y.VectorLength,y.DistanceSq,y.Distance,y.DotProduct,y.CrossProduct,y.GetVector,y.ClampPoint;var o=n(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){this.type=t};e.BoundingShape=n});e(o);o.BoundingShape;var v=n(function(t,e){var r,i=Q&&Q.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(n){function r(t){var e=n.call(this,r.type)||this;return e._points=t||[],e._boundingbox=null,e._dirtyFlag=0<e._points.length,e}return i(r,n),r.prototype.addPoint=function(t){this._points.push(t),this._dirtyFlag=!0},Object.defineProperty(r.prototype,"length",{get:function(){return this._points.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"boundingbox",{get:function(){return this._checkDirty(),this._boundingbox},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"points",{get:function(){return this._checkDirty(),this._points},enumerable:!0,configurable:!0}),r.prototype.getPoint=function(t){return this._checkDirty(),this._points[t]},r.prototype.removePoint=function(t){this._points.splice(t,1),0===this._points.length?(this._boundingbox=null,this._dirtyFlag=!1):this._dirtyFlag=!0},r.prototype.clear=function(){this._points.length=0,this._boundingbox=null,this._dirtyFlag=!1},r.prototype.getBoundingbox=function(){return this.boundingbox},r.prototype.getTransformedShape=function(e){return new r(e?this._points.map(function(t){return e.transformPoint(t)}):this._points)},r.prototype._checkDirty=function(){this._dirtyFlag&&(this._dirtyFlag=!1,this._adjustPoints(),this._computeBoundingbox())},r.prototype._adjustPoints=function(){var t=this._points.length;if(!(t<3)){for(var e=[this._points[0],this._points[1]],n=2;n<t;n++){for(var r=e.length-1;0<r;){var i=y.GetVector(e[0],e[r]),o=y.GetVector(e[0],this._points[n]),a=y.CrossProduct(i,o);if(a<0){e.splice(r+1,0,this._points[n]);break}if(0===a&&y.VectorLengthSq(o)>y.VectorLengthSq(i)){e.splice(r+1,0,this._points[n]);break}r--}0===r&&e.splice(1,0,this._points[n])}this._points=e}},r.prototype._computeBoundingbox=function(){if(0<this._points.length){var r=this._points[0].x,i=this._points[0].y,o=r,a=i;this._points.forEach(function(t){var e=t.x,n=t.y;e<r?r=e:o<e&&(o=e),n<i?i=n:a<n&&(a=n)}),this._boundingbox={x:r,y:i,w:o-r+1,h:a-i+1}}else this._boundingbox=null},r.type="Hull",r}(o.BoundingShape);e.BoundingHull=n});e(v);v.BoundingHull;var _=n(function(t,e){var r,i=Q&&Q.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(n){function o(t){var e=n.call(this,o.type)||this;return e.rect=t||null,e}return i(o,n),o.prototype.getBoundingbox=function(){return this.rect},o.prototype.getTransformedShape=function(t){if(null===this.rect)return null;if(t){var e={x:this.rect.x,y:this.rect.y},n={x:this.rect.x,y:this.rect.y+this.rect.h-1},r={x:this.rect.x+this.rect.w-1,y:this.rect.y+this.rect.h-1},i={x:this.rect.x+this.rect.w-1,y:this.rect.y};return new v.BoundingHull([t.transformPoint(e),t.transformPoint(n),t.transformPoint(r),t.transformPoint(i)])}return new o(this.rect)},o.type="Box",o}(o.BoundingShape);e.BoundingBox=n});e(_);_.BoundingBox;var m=n(function(t,e){var r,i=Q&&Q.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(n){function r(t){var e=n.call(this,r.type)||this;return e._segment=t||null,e._dirty=!!t,e._boundingbox=null,e}return i(r,n),Object.defineProperty(r.prototype,"start",{get:function(){return this._segment?this._segment.start:null},set:function(t){t&&(this._segment?this._segment.start=t:this._segment={start:t,end:t},this._dirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"end",{get:function(){return this._segment?this._segment.end:null},set:function(t){t&&(this._segment?this._segment.end=t:this._segment={start:t,end:t},this._dirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"segment",{get:function(){return this._segment?{start:this.start,end:this.end}:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"boundingbox",{get:function(){return this._checkDirty(),this._boundingbox},enumerable:!0,configurable:!0}),r.prototype.getBoundingbox=function(){return this.boundingbox},r.prototype.getTransformedShape=function(t){return t&&this._segment?new r({start:t.transformPoint(this._segment.start),end:t.transformPoint(this._segment.end)}):this._segment?new r(this._segment):null},r.prototype._checkDirty=function(){if(this._segment&&this._dirty){this._dirty=!1;var t=this._segment.start.x,e=this._segment.start.y,n=this._segment.end.x,r=this._segment.end.y;if(n<t){var i=t;t=n,n=i}if(r<e){i=e;e=r,r=i}this._boundingbox={x:t,y:e,w:n-t+1,h:r-e+1}}},r.type="Segment",r}(o.BoundingShape);e.BoundingSegment=n});e(m);m.BoundingSegment;var b=n(function(t,e){var r,i=Q&&Q.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(n){function s(t){var e=n.call(this,s.type)||this;return e._sphere=t||null,e._dirty=!!e._sphere,e._boundingbox=null,e}return i(s,n),Object.defineProperty(s.prototype,"center",{get:function(){return this._sphere?this._sphere.center:null},set:function(t){t&&(this._sphere?this._sphere.center=t:this._sphere={center:t,radius:1},this._dirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"radius",{get:function(){return this._sphere?this._sphere.radius:null},set:function(t){null!==t&&(this._sphere?this._sphere.radius=t:this._sphere={center:{x:0,y:0},radius:t},this._dirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"sphere",{get:function(){return this._sphere?{center:this._sphere.center,radius:this._sphere.radius}:null},set:function(t){this._sphere=t,this._dirty=!!t,this._boundingbox=null},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"boundingbox",{get:function(){return this._checkDirty(),this._boundingbox},enumerable:!0,configurable:!0}),s.prototype.getBoundingbox=function(){return this.boundingbox},s.prototype.getTransformedShape=function(t){if(t&&this._sphere){for(var e=.125*Math.PI,n=2*e,r=this._sphere.radius/Math.cos(e),i=new v.BoundingHull,o=e;o<2*Math.PI;o+=n){var a=t.transformPoint({x:r*Math.cos(o),y:r*Math.sin(o)});a.x=Math.round(a.x),a.y=Math.round(a.y),i.addPoint(a)}return i}return this._sphere?new s(this._sphere):null},s.prototype._checkDirty=function(){this._sphere&&this._dirty&&(this._dirty=!1,this._boundingbox={x:this._sphere.center.x-this._sphere.radius+1,y:this._sphere.center.y-this._sphere.radius+1,w:2*this._sphere.radius-1,h:2*this._sphere.radius-1})},s.type="sphere",s}(o.BoundingShape);e.BoundingSphere=n});e(b);b.BoundingSphere;var Z=n(function(t,e){function n(t,e){return!!t&&!!e&&t.x<=e.x+e.w&&t.x+t.w>=e.x&&t.y<=e.y+e.h&&t.y+t.h>=e.y}function r(t,e){return!!t&&!!e&&e.x>=t.x&&e.x<=t.x+t.w&&e.y>=t.y&&e.y<=t.y+t.h}function i(t,e){return!!t&&!!e&&p([y.GetTopLeft(t),y.GetBottomLeft(t),y.GetBottomRight(t),y.GetTopRight(t)],e)}function o(t,e){return t&&e?l([y.GetTopLeft(t),y.GetBottomLeft(t),y.GetBottomRight(t),y.GetTopRight(t)],e):null}function a(t,e){if(!t||!e)return!1;var n=y.ClampPoint(e.center,{x:t.x,y:t.y},{x:t.x+t.w-1,y:t.y+t.h-1}),r=y.GetVector(n,e.center);return y.DotProduct(r,r)<e.radius*e.radius}function s(t,e){if(!t||!e)return!1;for(var n=t.radius*t.radius,r=0;r<e.length;r++){var i=t.center.x-e[r].x,o=t.center.y-e[r].y;if(i*i+o*o<n)return!0}for(r=0;r<e.length;r++){var a=h(t,{start:e[r],end:e[(r+1)%e.length]});if(null!==a&&0<a.length)return!0}return u(e,t.center)}function u(t,e){for(var n=0;n<t.length;n++){var r=y.GetVector(e,t[n]),i=y.GetVector(e,t[(n+1)%t.length]);if(0<y.CrossProduct(r,i))return!1}return!0}function c(t,e){if(!t||!e)return!1;var n=t.center.x-e.center.x,r=t.center.y-e.center.y,i=t.radius+e.radius;return n*n+r*r<i*i}function h(t,e){if(!t||!e)return null;var n=y.GetVector(e.start,e.end),r=y.GetVector(t.center,e.start),i=y.DotProduct(n,n),o=2*y.DotProduct(r,n),a=o*o-4*i*(y.DotProduct(r,r)-t.radius*t.radius);if(a<0)return null;var s=(-o-(a=Math.sqrt(a)))/(2*i),u=(-o+a)/(2*i);if(u<s){var c=s;s=u,u=c}var h=[];return 0<=s&&s<=1&&h.push({x:e.start.x+s*n.x,y:e.start.y+s*n.y}),0<=u&&u<=1&&h.push({x:e.start.x+u*n.x,y:e.start.y+u*n.y}),h}function l(t,n){if(!t||!n)return null;if(u(t,n.start)&&u(t,n.end))return[];for(var e=[],r=0;r<t.length;r++){var i=d({start:t[r],end:t[(r+1)%t.length]},n);i&&e.push(i)}return 1<e.length&&e.sort(function(t,e){return y.DistanceSq(t,n.start)-y.DistanceSq(e,n.start)}),0<e.length?e:null}function p(t,e){for(var c=[t,e],n=0;n<2;n++)for(var h=c[n],r=function(t){var e=h[(t+1)%h.length].x-h[t].x,n=h[(t+1)%h.length].y-h[t].y,r=Math.sqrt(e*e+n*n);if(r<1)return"continue";for(var i=-n/r,o=e/r,a=[{min:9999999,max:-9999999},{min:9999999,max:-9999999}],s=function(n){c[n].forEach(function(t){var e=t.x*i+t.y*o;e<a[n].min&&(a[n].min=e),e>a[n].max&&(a[n].max=e)})},u=0;u<2;u++)s(u);return a[0].min>a[1].max||a[0].max<a[1].min?{value:!1}:void 0},i=0;i<h.length;i++){var o=r(i);if("object"==typeof o)return o.value}return!0}function f(t,e){if(!t||!e)return!1;var n=t.center.x-e.x,r=t.center.y-e.y;return n*n+r*r<t.radius*t.radius}function g(t,e){if(!t||!e)return!1;var n=t.start.x,r=t.start.y,i=t.end.x,o=t.end.y;if(i<n){var a=n;n=i,i=a}if(o<r){a=r;r=o,o=a}if(e.x<n||e.x>i||e.y<r||e.y>o)return!1;if(i!==n){var s=Math.round(r+(o-r)*(e.x-n)/(i-n))-e.y;return-1<=s&&s<=1}if(o===r)return e.x===n&&e.y===r;var u=Math.round(n+(i-n)*(e.y-r)/(o-r))-e.x;return-1<=u&&u<=1}function d(t,e){function n(t,e){return 0<=t&&0<=e||t<=0&&e<=0}if(!t||!e)return null;var r,i,o,a,s,u=t.start.x,c=t.start.y,h=t.end.x,l=t.end.y,p=e.start.x,f=e.start.y,g=e.end.x,d=e.end.y,y=h-u,v=p-g;if(y<0?(r=h,i=u):(i=h,r=u),0<v){if(i<g||p<r)return null}else if(i<p||g<r)return null;var _=l-c,m=f-d;if(_<0?(o=l,a=c):(a=l,o=c),0<m){if(a<d||f<o)return null}else if(a<f||d<o)return null;var b=u-p,k=c-f,w=_*v-y*m;if(0===w)return null;var x=m*b-v*k;if(0<w){if(x<0||w<x)return null}else if(0<x||x<w)return null;var P=y*k-_*b;if(0<w){if(P<0||w<P)return null}else if(0<P||P<w)return null;return{x:u+(((s=x*y)+(n(s,w)?w/2:-w/2))/w>>0),y:c+(((s=x*_)+(n(s,w)?w/2:-w/2))/w>>0)}}Object.defineProperty(e,"__esModule",{value:!0}),e.IntersectionTestShapeSegment=function(t,e){if(!t||!e)return null;if(t.getBoundingbox())switch(t.type){case _.BoundingBox.type:return o(t.rect,e);case v.BoundingHull.type:return l(t.points,e);case m.BoundingSegment.type:var n=d(t.segment,e);return n?[n]:[];case b.BoundingSphere.type:return h(t.sphere,e)}return null},e.IntersectionTestShapeBox=function(t,e){if(!t.getBoundingbox())return!1;switch(t.type){case _.BoundingBox.type:return n(t.rect,e);case v.BoundingHull.type:return i(e,t.points);case m.BoundingSegment.type:return null!=o(e,t.segment);case b.BoundingSphere.type:return a(e,t.sphere);default:return!1}},e.IntersectionTestShapeHull=function(t,e){if(!t.getBoundingbox())return!1;switch(t.type){case _.BoundingBox.type:return i(t.rect,e);case v.BoundingHull.type:return p(t.points,e);case m.BoundingSegment.type:return null!=l(e,t.segment);case b.BoundingSphere.type:return s(t.sphere,e);default:return!1}},e.IntersectionTestShapePoint=function(t,e){if(!r(t.getBoundingbox(),e))return!1;switch(t.type){case _.BoundingBox.type:return!0;case v.BoundingHull.type:return u(t.points,e);case m.BoundingSegment.type:return g(t.segment,e);case b.BoundingSphere.type:return f(t.sphere,e);default:return!1}},e.IntersectionTestShapeShape=function(t,e){if(!n(t.getBoundingbox(),e.getBoundingbox()))return!1;switch(t.type){case _.BoundingBox.type:switch(e.type){case _.BoundingBox.type:return!0;case v.BoundingHull.type:return i(t.rect,e.points);case m.BoundingSegment.type:return null!=o(t.rect,e.segment);case b.BoundingSphere.type:return a(t.rect,e.sphere);default:return!1}case v.BoundingHull.type:switch(e.type){case _.BoundingBox.type:return i(e.rect,t.points);case v.BoundingHull.type:return p(t.points,e.points);case m.BoundingSegment.type:return null!=l(t.points,e.segment);case b.BoundingSphere.type:return s(e.sphere,t.points);default:return!1}case m.BoundingSegment.type:switch(e.type){case _.BoundingBox.type:return null!=o(e.rect,t.segment);case v.BoundingHull.type:return null!=l(e.points,t.segment);case m.BoundingSegment.type:return null!=d(e.segment,t.segment);case b.BoundingSphere.type:return null!=h(e.sphere,t.segment);default:return!1}case b.BoundingSphere.type:switch(e.type){case _.BoundingBox.type:return a(e.rect,t.sphere);case v.BoundingHull.type:return s(t.sphere,e.points);case m.BoundingSegment.type:return null!=h(t.sphere,e.segment);case b.BoundingSphere.type:return c(t.sphere,e.sphere);default:return!1}default:return!1}},e.IntersectionTestBoxBox=n,e.IntersectionTestBoxPoint=r,e.IntersectionTestBoxHull=i,e.IntersectionTestBoxSegment=o,e.IntersectionTestBoxSphere=a,e.IntersectionTestSphereHull=s,e.IntersectionTestHullPoint=u,e.IntersectionTestSphereSphere=c,e.IntersectionTestSphereSegment=h,e.IntersectionTestHullSegment=l,e.IntersectionTestHullHull=p,e.IntersectionTestSpherePoint=f,e.IntersectionTestSegmentPoint=g,e.IntersectionTestSegmentSegment=d});e(Z);Z.IntersectionTestShapeSegment,Z.IntersectionTestShapeBox,Z.IntersectionTestShapeHull,Z.IntersectionTestShapePoint,Z.IntersectionTestShapeShape,Z.IntersectionTestBoxBox,Z.IntersectionTestBoxPoint,Z.IntersectionTestBoxHull,Z.IntersectionTestBoxSegment,Z.IntersectionTestBoxSphere,Z.IntersectionTestSphereHull,Z.IntersectionTestHullPoint,Z.IntersectionTestSphereSphere,Z.IntersectionTestSphereSegment,Z.IntersectionTestHullSegment,Z.IntersectionTestHullHull,Z.IntersectionTestSpherePoint,Z.IntersectionTestSegmentPoint,Z.IntersectionTestSegmentSegment;var h=n(function(t,e){var r,u,n,i=Q&&Q.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),(n=u=e.SplineType||(e.SplineType={}))[n.STEP=1]="STEP",n[n.LINEAR=2]="LINEAR",n[n.POLY=3]="POLY";var o=function(){function t(t,e){void 0===e&&(e=!1),this.cp=t,this.clamp=e}return t.prototype.eval=function(t){return 0},t.prototype.evalFirst=function(){return 0<this.cp.length?this.cp[0].y:0},t.prototype.evalLast=function(){return 0<this.cp.length?this.cp[this.cp.length-1].y:0},t}(),c=function(r){function t(t,e){void 0===e&&(e=!1);var n=r.call(this,t,e)||this;return n.h=new Array(t.length-1),n.compute(),n}return i(t,r),t.prototype.compute=function(){for(var t=0;t<this.cp.length-1;++t)this.h[t]=this.cp[t+1].x-this.cp[t].x},t.prototype.getSegment=function(t){var e;for(e=0;e<this.cp.length-1&&!(t<this.cp[e+1].x);e++);return e},t.prototype.eval=function(t){if(this.clamp){if(t<0)return this.cp[0].y;if(t>this.cp[this.cp.length-1].x)return this.cp[this.cp.length-1].y}var e=this.getSegment(t);return this.cp[e].y},t}(e.CurveEvaluter=o);e.StepEvaluter=c;var h=function(r){function t(t,e){void 0===e&&(e=!1);var n=r.call(this,t,e)||this;return n.h=new Array(t.length-1),n.cp=t,n.compute(),n}return i(t,r),t.prototype.compute=function(){for(var t=0;t<this.cp.length-1;++t)this.h[t]=this.cp[t+1].x-this.cp[t].x},t.prototype.getSegment=function(t){var e;for(e=0;e<this.cp.length-1&&!(t<this.cp[e+1].x);e++);return e===this.cp.length-1&&e--,e},t.prototype.eval=function(t){if(this.clamp){if(t<0)return this.cp[0].y;if(t>this.cp[this.cp.length-1].x)return this.cp[this.cp.length-1].y}var e=this.getSegment(t),n=t-this.cp[e].x;return this.cp[e].y+(this.cp[e+1].y-this.cp[e].y)*n/this.h[e]},t}(o);e.CoLinearEvaluter=h;var l=function(r){function t(t,e){void 0===e&&(e=!1);var n=r.call(this,t,e)||this;return n.a=new Array(t.length),n.h=new Array(t.length),n.cp=t,n.compute(),n}return i(t,r),t.prototype.solveTridiag=function(t,e,n){for(var r=this.cp.length-2,i=2;i<=r;i++)t[i]/=e[i-1],e[i]-=t[i]*n[i-1],this.a[i]-=this.a[i-1]*t[i];this.a[r]/=e[r];for(i=r-1;1<=i;--i)this.a[i]=(this.a[i]-this.a[i+1]*n[i])/e[i]},t.prototype.compute=function(){var t=this.cp.length,e=new Array(t-1),n=new Array(t-1),r=new Array(t-1);this.a[0]=0,this.a[t-1]=0;for(var i=1;i<t;++i)this.h[i]=this.cp[i].x-this.cp[i-1].x;for(i=1;i<t-1;++i)n[i]=(this.h[i]+this.h[i+1])/3,r[i]=this.h[i+1]/6,e[i]=this.h[i]/6,this.a[i]=(this.cp[i+1].y-this.cp[i].y)/this.h[i+1]-(this.cp[i].y-this.cp[i-1].y)/this.h[i];this.solveTridiag(e,n,r)},t.prototype.getSegment=function(t){var e;for(e=0;e<this.cp.length-1&&!(t<this.cp[e+1].x);e++);return e===this.cp.length-1&&e--,e},t.prototype.eval=function(t){if(this.clamp){if(t<0)return this.cp[0].y;if(t>this.cp[this.cp.length-1].x)return this.cp[this.cp.length-1].y}var e=this.getSegment(t)+1,n=t-this.cp[e-1].x,r=this.h[e]-n;return((-this.a[e-1]/6*(r+this.h[e])*n+this.cp[e-1].y)*r+(-this.a[e]/6*(n+this.h[e])*r+this.cp[e].y)*n)/this.h[e]},t}(o);e.PolynomialsEvaluter=l;var a=function(){function t(t,e,n){void 0===n&&(n=!1),this._evalutors=[],this._array=!1,0<e.length&&("number"==typeof e[0].y?this.initNonArray(t,e,n):this.initArray(t,e,n))}return t.prototype.eval=function(e){if(0<this._evalutors.length){if(this._array){var n=[];return this._evalutors.forEach(function(t){n.push(t.eval(e))}),n}return this._evalutors[0].eval(e)}return 0},t.prototype.evalFirst=function(){if(0<this._evalutors.length){if(this._array){var e=[];return this._evalutors.forEach(function(t){e.push(t.evalFirst())}),e}return this._evalutors[0].evalFirst()}return 0},t.prototype.evalLast=function(){if(0<this._evalutors.length){if(this._array){var e=[];return this._evalutors.forEach(function(t){e.push(t.evalLast())}),e}return this._evalutors[0].evalLast()}return 0},t.prototype.initArray=function(t,e,n){var r=e[0].y.length;if(0<r){for(var i=0;i<r;i++){for(var o=[],a=0;a<e.length;a++){var s=e[a].y.length>i?e[a].y[i]:0;o.push({x:e[a].x,y:s})}switch(t){case u.STEP:this._evalutors.push(new c(o,n));break;case u.LINEAR:this._evalutors.push(new h(o,n));break;case u.POLY:default:this._evalutors.push(new l(o,n))}}this._array=!0}},t.prototype.initNonArray=function(t,e,n){switch(t){case u.STEP:this._evalutors.push(new c(e,n));break;case u.LINEAR:this._evalutors.push(new h(e,n));break;case u.POLY:default:this._evalutors.push(new l(e,n))}this._array=!1},t}();e.Spline=a});e(h);h.SplineType,h.CurveEvaluter,h.StepEvaluter,h.CoLinearEvaluter,h.PolynomialsEvaluter,h.Spline;var r=n(function(t,e){var n;Object.defineProperty(e,"__esModule",{value:!0}),(n=e.KeyCode||(e.KeyCode={}))[n.kBackspace=8]="kBackspace",n[n.kTab=9]="kTab",n[n.kClear=12]="kClear",n[n.kEnter=13]="kEnter",n[n.kShift=16]="kShift",n[n.kControl=17]="kControl",n[n.kAlt=18]="kAlt",n[n.kPause=19]="kPause",n[n.kCapsLock=20]="kCapsLock",n[n.kEscape=27]="kEscape",n[n.kSpace=32]="kSpace",n[n.kPageUp=33]="kPageUp",n[n.kPageDown=34]="kPageDown",n[n.kEnd=35]="kEnd",n[n.kHome=36]="kHome",n[n.kLeft=37]="kLeft",n[n.kUp=38]="kUp",n[n.kRight=39]="kRight",n[n.kDown=40]="kDown",n[n.kSelect=41]="kSelect",n[n.kPrint=42]="kPrint",n[n.kExecute=43]="kExecute",n[n.kInsert=45]="kInsert",n[n.kDelete=46]="kDelete",n[n.kHelp=47]="kHelp",n[n.k0=48]="k0",n[n.k1=49]="k1",n[n.k2=50]="k2",n[n.k3=51]="k3",n[n.k4=52]="k4",n[n.k5=53]="k5",n[n.k6=54]="k6",n[n.k7=55]="k7",n[n.k8=56]="k8",n[n.k9=57]="k9",n[n.kA=65]="kA",n[n.kB=66]="kB",n[n.kC=67]="kC",n[n.kD=68]="kD",n[n.kE=69]="kE",n[n.kF=70]="kF",n[n.kG=71]="kG",n[n.kH=72]="kH",n[n.kI=73]="kI",n[n.kJ=74]="kJ",n[n.kK=75]="kK",n[n.kL=76]="kL",n[n.kM=77]="kM",n[n.kN=78]="kN",n[n.kO=79]="kO",n[n.kP=80]="kP",n[n.kQ=81]="kQ",n[n.kR=82]="kR",n[n.kS=83]="kS",n[n.kT=84]="kT",n[n.kU=85]="kU",n[n.kV=86]="kV",n[n.kW=87]="kW",n[n.kX=88]="kX",n[n.kY=89]="kY",n[n.kZ=90]="kZ",n[n.kLeftMeta=91]="kLeftMeta",n[n.kRightMeta=92]="kRightMeta",n[n.kMenu=93]="kMenu",n[n.kKP0=96]="kKP0",n[n.kKP1=97]="kKP1",n[n.kKP2=98]="kKP2",n[n.kKP3=99]="kKP3",n[n.kKP4=100]="kKP4",n[n.kKP5=101]="kKP5",n[n.kKP6=102]="kKP6",n[n.kKP7=103]="kKP7",n[n.kKP8=104]="kKP8",n[n.kKP9=105]="kKP9",n[n.kKPMul=106]="kKPMul",n[n.kKPAdd=107]="kKPAdd",n[n.kKPSep=108]="kKPSep",n[n.kKPSub=109]="kKPSub",n[n.kKPDec=110]="kKPDec",n[n.kKPDiv=111]="kKPDiv",n[n.kF1=112]="kF1",n[n.kF2=113]="kF2",n[n.kF3=114]="kF3",n[n.kF4=115]="kF4",n[n.kF5=116]="kF5",n[n.kF6=117]="kF6",n[n.kF7=118]="kF7",n[n.kF8=119]="kF8",n[n.kF9=120]="kF9",n[n.kF10=121]="kF10",n[n.kF11=122]="kF11",n[n.kF12=123]="kF12",n[n.kNumLock=144]="kNumLock",n[n.kScrollLock=145]="kScrollLock",n[n.kAdd=187]="kAdd",n[n.kComma=188]="kComma",n[n.kMinus=189]="kMinus",n[n.kPeriod=190]="kPeriod",n[n.kApostrophe=192]="kApostrophe",n[n.kLeftBrace=219]="kLeftBrace",n[n.kRightBrace=221]="kRightBrace",n[n.kBackSlash=220]="kBackSlash",n[n.kQuot=222]="kQuot",n[n.kSemicolon=186]="kSemicolon",n[n.kSlash=191]="kSlash"});e(r);r.KeyCode;var J=n(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function r(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}return r.getIdentity=function(){return new r},r.getTranslate=function(t,e){return(new r).makeTranslate(t,e)},r.getScale=function(t,e){return(new r).makeScale(t,e)},r.getRotate=function(t){return(new r).makeRotate(t)},r.transform=function(t,e){return(new r).copyFrom(t).transform(e)},r.translate=function(t,e,n){return(new r).copyFrom(t).translate(e,n)},r.scale=function(t,e,n){return(new r).copyFrom(t).scale(e,n)},r.rotate=function(t,e){return(new r).copyFrom(t).rotate(e)},r.invert=function(t){return(new r).copyFrom(t).invert()},r.prototype.set=function(t,e,n,r,i,o){return this.a=t,this.b=e,this.c=n,this.d=r,this.e=i,this.f=o,this},r.prototype.makeIdentity=function(){return this.set(1,0,0,1,0,0)},r.prototype.makeTranslate=function(t,e){return this.set(1,0,0,1,t,e)},r.prototype.makeScale=function(t,e){return this.set(t,0,0,e,0,0)},r.prototype.makeRotate=function(t){var e=Math.sin(t),n=Math.cos(t);return this.set(n,e,-e,n,0,0)},r.prototype.copyFrom=function(t){return this.set(t.a,t.b,t.c,t.d,t.e,t.f)},r.prototype.transform=function(t){return this.set(this.a*t.a+this.c*t.b,this.b*t.a+this.d*t.b,this.a*t.c+this.c*t.d,this.b*t.c+this.d*t.d,this.a*t.e+this.c*t.f+this.e,this.b*t.e+this.d*t.f+this.f)},r.prototype.transformPoint=function(t){return{x:Math.round(this.a*t.x+this.c*t.y+this.e),y:Math.round(this.b*t.x+this.d*t.y+this.f)}},r.prototype.translate=function(t,e){return this.transform(r.getTranslate(t,e))},r.prototype.scale=function(t,e){return this.transform(r.getScale(t,e))},r.prototype.rotate=function(t){return this.transform(r.getRotate(t))},r.prototype.invert=function(){var t=this.a,e=this.b,n=this.c,r=this.d,i=this.e,o=this.f,a=1*r-0*o,s=-1*n+0*i,u=o*n-r*i,c=t*a+e*s+0*u;return c&&(c=1/c,this.a=a*c,this.b=(-1*e+0*o)*c,this.c=s*c,this.d=(1*t-0*i)*c,this.e=u*c,this.f=(-o*t+e*i)*c),this},r.prototype.getTranslationPart=function(){return{x:this.e,y:this.f}},r.prototype.setTranslationPart=function(t){this.e=t.x,this.f=t.y},r.prototype.getScalePart=function(){return{x:Math.sqrt(this.a*this.a+this.b*this.b),y:Math.sqrt(this.c*this.c+this.d*this.d)}},r.prototype.setScalePart=function(t){var e=this.getScalePart(),n=t.x/e.x;this.a*=n,this.b*=n;var r=t.y/e.y;this.c*=r,this.d*=r},r.prototype.getRotationPart=function(){var t=Math.sqrt(this.a*this.a+this.b*this.b);if(0===t)return 0;var e=Math.max(Math.min(this.a/t,1),-1),n=Math.max(Math.min(this.b/t,1),-1),r=Math.acos(e);return 0<=n?r:2*Math.PI-r},r.prototype.setRotationPart=function(t){var e=this.getScalePart(),n=Math.sin(t),r=Math.cos(t);this.a=e.x*r,this.b=e.x*n,this.c=-e.y*n,this.d=e.y*r},r}();e.Matrix2d=n});e(J);J.Matrix2d;var l=n(function(t,e){var r,s,n,p=Q&&Q.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),(n=s=e.EventListenerOrder||(e.EventListenerOrder={}))[n.FIRST=1]="FIRST",n[n.LAST=2]="LAST";var i=function(){function t(t){this.type=t,this.eaten=!1}return t.prototype.eat=function(){this.eaten=!0},t}(),o=function(n){function r(t){var e=n.call(this,r.type)||this;return e.object=t,e.allow=!0,e}return p(r,n),r.type="@componentBeforeAttach",r}(e.BaseEvent=i);e.EvtComponentBeforeAttach=o;var a=function(t){function e(){return t.call(this,e.type)||this}return p(e,t),e.type="@componentAttached",e}(i);e.EvtComponentAttached=a;var u=function(e){function n(){var t=e.call(this,n.type)||this;return t.allow=!0,t}return p(n,e),n.type="@componentBeforeDetach",n}(i);e.EvtComponentBeforeDetach=u;var c=function(t){function e(){return t.call(this,e.type)||this}return p(e,t),e.type="@componentDetached",e}(i);e.EvtComponentDetached=c;var h=function(i){function o(t,e,n){var r=i.call(this,o.type)||this;return r.deltaTime=t,r.elapsedTime=e,r.frameStamp=n,r}return p(o,i),o.type="@update",o}(i);e.EvtUpdate=h;var l=function(r){function i(t,e){var n=r.call(this,i.type)||this;return n.canvasWidth=t,n.canvasHeight=e,n.result={},n}return p(i,r),i.prototype.addObject=function(t,e,n){var r=this.result[e]||[];r.push({object:t,z:e,transform:n}),this.result[e]=r},i.type="@cull",i}(i);e.EvtCull=l;var f=function(i){function o(t,e,n){var r=i.call(this,o.type)||this;return r.canvas=t,r.z=e,r.transform=n,r}return p(o,i),o.type="@draw",o}(i);e.EvtDraw=f;var g=function(r){function i(t,e){var n=r.call(this,i.type)||this;return n.x=t,n.y=e,n.result=!1,n}return p(i,r),i.type="@hittest",i}(i);e.EvtHitTest=g;var d=function(t){function e(){return t.call(this,e.type)||this}return p(e,t),e.type="@getboundingshape",e}(i);e.EvtGetBoundingShape=d;var y=function(i){function o(t,e,n){var r=i.call(this,o.type)||this;return r.deltaTime=t,r.elapsedTime=e,r.frameStamp=n,r}return p(o,i),o.type="@frame",o}(i);e.EvtFrame=y;var v=function(n){function r(t){var e=n.call(this,r.type)||this;return e.focus=t,e}return p(r,n),r.type="@focus",r}(i);e.EvtFocus=v;var _=function(u){function t(t,e,n,r,i,o,a){var s=u.call(this,t)||this;return s.key=e,s.keyCode=n,s.shiftDown=r,s.altDown=i,s.ctrlDown=o,s.metaDown=a,s}return p(t,u),t}(i),m=function(a){function s(t,e,n,r,i,o){return a.call(this,s.type,t,e,n,r,i,o)||this}return p(s,a),s.type="@keydown",s}(e.EvtKeyboard=_);e.EvtKeyDown=m;var b=function(a){function s(t,e,n,r,i,o){return a.call(this,s.type,t,e,n,r,i,o)||this}return p(s,a),s.type="@keyup",s}(_);e.EvtKeyUp=b;var k=function(a){function s(t,e,n,r,i,o){return a.call(this,s.type,t,e,n,r,i,o)||this}return p(s,a),s.type="@keypress",s}(_);e.EvtKeyPress=k;var w=function(c){function t(t,e,n,r,i,o,a,s){var u=c.call(this,t)||this;return u.x=e,u.y=n,u.button=r,u.shiftDown=i,u.altDown=o,u.ctrlDown=a,u.metaDown=s,u.bubble=!0,u}return p(t,c),t.prototype.cancelBubble=function(){this.bubble=!1},t}(i),x=function(s){function u(t,e,n,r,i,o,a){return s.call(this,u.type,t,e,n,r,i,o,a)||this}return p(u,s),u.type="@mousedown",u}(e.EvtMouse=w);e.EvtMouseDown=x;var P=function(s){function u(t,e,n,r,i,o,a){return s.call(this,u.type,t,e,n,r,i,o,a)||this}return p(u,s),u.type="@mouseup",u}(w);e.EvtMouseUp=P;var E=function(s){function u(t,e,n,r,i,o,a){return s.call(this,u.type,t,e,n,r,i,o,a)||this}return p(u,s),u.type="@mousemove",u}(w);e.EvtMouseMove=E;var S=function(t){function e(){return t.call(this,e.type)||this}return p(e,t),e.type="@mouseenter",e}(i);e.EvtMouseEnter=S;var O=function(t){function e(){return t.call(this,e.type)||this}return p(e,t),e.type="@mouseleave",e}(i);e.EvtMouseLeave=O;var j=function(s){function u(t,e,n,r,i,o,a){return s.call(this,u.type,t,e,n,r,i,o,a)||this}return p(u,s),u.type="@click",u}(w);e.EvtClick=j;var T=function(s){function u(t,e,n,r,i,o,a){return s.call(this,u.type,t,e,n,r,i,o,a)||this}return p(u,s),u.type="@dblclick",u}(w);e.EvtDblClick=T;var C=function(u){function c(t,e,n,r,i,o,a){var s=u.call(this,c.type,t,e,n,r,i,o,a)||this;return s.data=null,s}return p(c,u),c.type="@dragbegin",c}(w);e.EvtDragBegin=C;var B=function(c){function h(t,e,n,r,i,o,a,s){var u=c.call(this,h.type,t,e,n,r,i,o,a)||this;return u.data=s,u}return p(h,c),h.type="@dragend",h}(w);e.EvtDragEnd=B;var D=function(c){function h(t,e,n,r,i,o,a,s){var u=c.call(this,h.type,t,e,n,r,i,o,a)||this;return u.data=s,u}return p(h,c),h.type="@dragging",h}(w);e.EvtDragging=D;var I=function(h){function l(t,e,n,r,i,o,a,s,u){var c=h.call(this,l.type,t,e,n,r,i,o,a)||this;return c.object=s,c.data=u,c}return p(l,h),l.type="@dragover",l}(w);e.EvtDragOver=I;var M=function(h){function l(t,e,n,r,i,o,a,s,u){var c=h.call(this,l.type,t,e,n,r,i,o,a)||this;return c.object=s,c.data=u,c}return p(l,h),l.type="@dragdrop",l}(w);e.EvtDragDrop=M;var V=function(t){function e(){return t.call(this,e.type)||this}return p(e,t),e.type="@resize",e}(i);e.EvtResize=V;var L=function(n){function r(t){var e=n.call(this,r.type)||this;return e.view=t,e}return p(r,n),r.type="@canvasresize",r}(i);e.EvtCanvasResize=L;var R=function(n){function r(t){var e=n.call(this,r.type)||this;return e.propName=t,e.propValue=void 0,e}return p(r,n),r.type="@getprop",r}(i);e.EvtGetProp=R;var A=function(r){function i(t,e){var n=r.call(this,i.type)||this;return n.propName=t,n.propValue=e,n}return p(i,r),i.type="@setprop",i}(i);e.EvtSetProp=A;var K=function(i){function o(t,e,n){var r=i.call(this,o.type)||this;return r.view=t,r.oldPage=e,r.newPage=n,r}return p(o,i),o.type="@scenviewpagewillchange",o}(i);e.EvtSceneViewPageWillChange=K;var F=function(i){function o(t,e,n){var r=i.call(this,o.type)||this;return r.view=t,r.oldPage=e,r.newPage=n,r}return p(o,i),o.type="@sceneviewpagechanged",o}(i);e.EvtSceneViewPageChanged=F;var H=function(){function t(){}return t.isWindows=function(){return this._isWindows},t.isMac=function(){return this._isMac},t.isUnix=function(){return this._isX11&&!this._isWindows&&!this._isMac},t.isLinux=function(){return this._isLinux},t.isAndroid=function(){return this._isLinux&&this._isAndroid},t._isWindows="Win32"===navigator.platform||"Windows"===navigator.platform,t._isMac="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform,t._isX11="X11"===navigator.platform,t._isLinux=0<=String(navigator.platform).indexOf("Linux"),t._isAndroid=0<=(navigator.userAgent.toLowerCase().match(/android/i)||[]).indexOf("android"),t}();e.EvtSysInfo=H;var z=function(){function t(){}return t.prototype.on=function(t,e,n){N.addEventListener(t,this,e,n||s.FIRST)},t.prototype.off=function(t,e){N.removeEventListener(t,this,e)},t.prototype.trigger=function(t){N.triggerEvent(this,t)},t.prototype.triggerEx=function(t){this.trigger(t)},t.prototype.post=function(t){N.postEvent(this,t)},t}();e.EventObserver=z;var N=function(){function n(){}return n.postEvent=function(t,e){this.eventQueue.push({evt:e,target:t})},n.triggerEvent=function(t,e){this.processEvent(e,t)},n.processPendingEvents=function(){var e=this,t=this.eventQueue;this.eventQueue=[],t.forEach(function(t){e.processEvent(t.evt,t.target)})},n.addEventListener=function(t,e,n,r){for(var i=this.eventListeners[t]||[],o=0;o<i.length;o++)if(i[o].bindObject===e){if(r===s.FIRST)i[o].handlers={handler:n,next:i[o].handlers};else{var a=i[o].handlers;if(a){for(;a.next;)a=a.next;a.next={handler:n,next:null}}}return}i.push({bindObject:e,handlers:{handler:n,next:null}}),this.eventListeners[t]=i},n.removeEventListener=function(t,e,n){for(var r=this.eventListeners[t]||[],i=0;i<r.length;i++)if(r[i].bindObject===e){if(!n){r.splice(i,1);break}for(var o=r[i].handlers,a=null;o&&o.handler!==n;)o=(a=o).next;o&&(a?a.next=o.next:r[i].handlers=o.next),r[i].handlers||r.splice(i,1)}},n.run=function(){this.running||(this.running=!0,this.lastFrameTime=0,this.firstFrameTime=0,this.elapsedTime=0,this.deltaTime=0,this.frameStamp=0,this.init(),requestAnimationFrame(function t(e){n.running&&(0===n.lastFrameTime&&(n.lastFrameTime=e,n.firstFrameTime=e),n.deltaTime=e-n.lastFrameTime,n.elapsedTime=e-n.firstFrameTime,n.lastFrameTime=e,n.frameStamp++,n.processPendingEvents(),n.triggerEvent(null,new y(n.deltaTime,n.elapsedTime,n.frameStamp)),n.running&&requestAnimationFrame(t))}))},n.addView=function(t){return!(!t||!t.canvas||this.findView(t.canvas.canvas))&&(this.views.push(t),this.focusView||this.setFocusView(t),!0)},n.addCanvas=function(t,e){if(this.findView(t))return null;var n=new W(t,void 0!==e&&e);return this.addView(n)?n:null},n.setFocusView=function(t){this.focusView!==t&&(this.focusView&&this.focusView.trigger(new v(!1)),this.focusView=t,this.focusView&&this.focusView.trigger(new v(!0)))},n.findView=function(t){for(var e=0;e<this.views.length;e++)if(this.views[e].canvas.canvas===t)return this.views[e];return null},n.removeView=function(t){for(var e=0;e<this.views.length;e++)this.views[e].canvas.canvas===t&&this.views.splice(e,1)},n.setCapture=function(t){this.capturedView=t},n.init=function(){this.initEventListeners()},n.processEvent=function(t,e){var n=this.eventListeners[t.type];if(n)for(var r=0;r<n.length;r++){var i=n[r];if(!e||i.bindObject===e){for(var o=i.handlers;o&&(o.handler.call(i.bindObject,t),!t.eaten);)o=o.next;if(e)break}}},n.hitView=function(t,e){if(null!==this.capturedView)return this.capturedView;for(var n=0;n<this.views.length;n++){var r=this.views[n],i=r.canvas.viewport_rect;if(t>=i.x&&t<i.x+i.w&&e>=i.y&&e<i.y+i.h)return r}return null},n.resizeHandler=function(){var e=new V;this.views.forEach(function(t){t.triggerEx(e)})},n.mouseDownHandler=function(t){this.clickTick=Date.now();var e=this.hitView(t.clientX,t.clientY);null!==e&&e.handleMouseDown(t)},n.mouseUpHandler=function(t){var e=this.hitView(t.clientX,t.clientY);if(null!==e){var n=Date.now();n<this.clickTick+this.clickTime?n<this.dblClickTick+this.dblclickTime?(e.handleDblClick(t),this.dblClickTick=0):(e.handleClick(t),this.dblClickTick=n):this.dblClickTick=0,e.handleMouseUp(t),this.clickTick=0}else this.clickTick=0,this.dblClickTick=0},n.mouseMoveHandler=function(t){var e=this.hitView(t.clientX,t.clientY);if(e!==this.hoverView&&(this.hoverView&&(this.hoverView.triggerEx(new O),this.hoverView=null),null!==e&&(this.hoverView=e).triggerEx(new S)),null!==e){var n=e.canvas.viewport_rect;e.updateHitObjects(t.clientX-n.x,t.clientY-n.y),e.handleMouseMove(t)}},n.keyDownHandler=function(t){this.focusView&&this.focusView.trigger(new m(t.key,t.keyCode,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey))},n.keyUpHandler=function(t){this.focusView&&this.focusView.trigger(new b(t.key,t.keyCode,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey))},n.keyPressHandler=function(t){this.focusView&&this.focusView.trigger(new k(t.key,t.keyCode,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey))},n.initEventListeners=function(){window.addEventListener("resize",this.resizeHandler.bind(this)),window.addEventListener(window.onpointerdown?"pointerdown":"mousedown",this.mouseDownHandler.bind(this)),window.addEventListener(window.onpointerup?"pointerup":"mouseup",this.mouseUpHandler.bind(this)),window.addEventListener(window.onpointermove?"pointermove":"mousemove",this.mouseMoveHandler.bind(this)),window.addEventListener("keydown",this.keyDownHandler.bind(this)),window.addEventListener("keyup",this.keyUpHandler.bind(this)),window.addEventListener("keypress",this.keyPressHandler.bind(this))},n.elapsedTime=0,n.deltaTime=0,n.eventQueue=[],n.eventListeners={},n.running=!1,n.lastFrameTime=0,n.firstFrameTime=0,n.frameStamp=0,n.capturedView=null,n.hoverView=null,n.focusView=null,n.views=[],n.clickTick=0,n.dblClickTick=0,n.clickTime=400,n.dblclickTime=400,n}();e.App=N;var G=function(n){function t(t){var e=n.call(this)||this;return e.type=t,e.object=null,e}return p(t,n),t.prototype.toString=function(){return"<Component: "+this.type+">"},t}(z);e.Component=G;var U=function(n){function t(){var t=n.call(this)||this;return t.components={},t}return p(t,n),t.prototype.toString=function(){return"<BaseObject>"},t.prototype.addComponent=function(t){if(null===t.object){var e=this.components[t.type]||[];if(e.indexOf(t)<0){var n=new o(this);t.trigger(n),n.object=null,n.allow&&(e.push(t),t.object=this,t.trigger(new a))}this.components[t.type]=e}return this},t.prototype.removeComponent=function(t){if(t.object===this){var e=this.components[t.type].indexOf(t);this.removeComponentByIndex(t.type,e)}return this},t.prototype.removeComponentByIndex=function(t,e){var n=this.components[t];if(n&&0<=e&&e<n.length){var r=new u;n[e].trigger(r),r.allow&&(n[e].trigger(new c),n[e].object=null,n.splice(e,1))}return this},t.prototype.removeComponentsByType=function(t){for(var e=this.components[t];e&&0<e.length;)this.removeComponentByIndex(t,e.length-1);return this},t.prototype.removeAllComponents=function(){var e=this;return Object.keys(this.components).forEach(function(t){e.removeComponentsByType(t)}),this},t.prototype.getComponent=function(t,e){void 0===e&&(e=0);var n=this.components[t];return void 0===n||e<0||n.length<=e?null:n[e]},t.prototype.getComponents=function(t){return this.components[t]},t.prototype.triggerEx=function(e){for(var t in n.prototype.trigger.call(this,e),this.components)this.components.hasOwnProperty(t)&&this.components[t].forEach(function(t){t.trigger(e)})},t.prototype.post=function(t){N.postEvent(this,t)},t}(z),q=function(e){function t(t){var r=e.call(this)||this;return r._view=null,r._parent=null,r._z=0,r._visible=!0,r._children=[],r._localTransform=new J.Matrix2d,r._worldTranslation=null,r._worldRotation=null,r._worldScale=null,r._anchorPoint={x:0,y:0},t&&t.addChild(r),r.on(l.type,function(t){t.addObject(r,r.z,r.worldTransform)}),r.on(g.type,function(t){var e=r.boundingShape;t.result=!!e&&Z.IntersectionTestShapePoint(e,{x:t.x,y:t.y})}),r.on(R.type,function(t){switch(t.propName){case"z":t.propValue=r.z,t.eat();break;case"visible":t.propValue=r.visible,t.eat();break;case"transform":t.propValue=r.localTransform,t.eat();break;case"translation":var e=r.translation;t.propValue=[e.x,e.y],t.eat();break;case"scale":var n=r.scale;t.propValue=[n.x,n.y],t.eat();break;case"rotation":t.propValue=r.rotation,t.eat();break;case"anchorPoint":t.propValue=r.anchorPoint,t.eat()}}),r.on(A.type,function(t){switch(t.propName){case"z":r.z=t.propValue,t.eat();break;case"visible":r.visible=t.propValue,t.eat();break;case"transform":r.localTransform=t.propValue,t.eat();break;case"translation":var e=t.propValue;r.translation={x:Math.round(e[0]),y:Math.round(e[1])};break;case"scale":var n=t.propValue;r.scale={x:n[0],y:n[1]};break;case"rotation":r.rotation=t.propValue;break;case"anchorPoint":r.anchorPoint=t.propValue}}),r}return p(t,e),Object.defineProperty(t.prototype,"boundingShape",{get:function(){var t=new d;return this.triggerEx(t),t.shape||null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"view",{get:function(){return this._view},set:function(t){this._view=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this.setZ(t)},enumerable:!0,configurable:!0}),t.prototype.setZ=function(t){this._z=t},Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(t){this.setVisible(t)},enumerable:!0,configurable:!0}),t.prototype.setVisible=function(t){this._visible=t},Object.defineProperty(t.prototype,"localTransform",{get:function(){return this._localTransform},set:function(t){this.setLocalTransform(t)},enumerable:!0,configurable:!0}),t.prototype.setLocalTransform=function(t){this._localTransform=t},Object.defineProperty(t.prototype,"translation",{get:function(){return this.localTransform.getTranslationPart()},set:function(t){this.setTranslation(t)},enumerable:!0,configurable:!0}),t.prototype.setTranslation=function(t){this.localTransform.setTranslationPart(t)},Object.defineProperty(t.prototype,"scale",{get:function(){return this.localTransform.getScalePart()},set:function(t){this.setScale(t)},enumerable:!0,configurable:!0}),t.prototype.setScale=function(t){this.localTransform.setScalePart(t)},Object.defineProperty(t.prototype,"rotation",{get:function(){return this.localTransform.getRotationPart()},set:function(t){this.setRotation(t)},enumerable:!0,configurable:!0}),t.prototype.setRotation=function(t){this.localTransform.setRotationPart(t)},Object.defineProperty(t.prototype,"worldTransform",{get:function(){var t=this.parent?J.Matrix2d.transform(this.parent.worldTransform,this.localTransform):this.localTransform;return null!==this._worldTranslation&&t.setTranslationPart(this._worldTranslation),null!==this._worldRotation&&t.setRotationPart(this._worldRotation),null!==this._worldScale&&t.setScalePart(this._worldScale),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"worldTranslation",{get:function(){return this._worldTranslation},set:function(t){this.setWorldTranslation(t)},enumerable:!0,configurable:!0}),t.prototype.setWorldTranslation=function(t){this._worldTranslation=null===t?null:{x:Math.round(t.x),y:Math.round(t.y)}},Object.defineProperty(t.prototype,"worldRotation",{get:function(){return this._worldRotation},set:function(t){this.setWorldRotation(t)},enumerable:!0,configurable:!0}),t.prototype.setWorldRotation=function(t){this._worldRotation=t},Object.defineProperty(t.prototype,"worldScale",{get:function(){return this._worldScale},set:function(t){this.setWorldScale(t)},enumerable:!0,configurable:!0}),t.prototype.setWorldScale=function(t){this._worldScale=t},Object.defineProperty(t.prototype,"anchorPoint",{get:function(){return this._anchorPoint},set:function(t){this.setAnchorPoint(t)},enumerable:!0,configurable:!0}),t.prototype.setAnchorPoint=function(t){this._anchorPoint=t},Object.defineProperty(t.prototype,"numChildren",{get:function(){return this._children.length},enumerable:!0,configurable:!0}),t.prototype.collapseTransform=function(){var t=this.worldTransform;this.worldTranslation=null,this.worldRotation=null,this.worldScale=null,this.parent?this.localTransform=J.Matrix2d.invert(this.parent.worldTransform).transform(t):this.localTransform=t,this.localTransform.e=Math.round(this.localTransform.e),this.localTransform.f=Math.round(this.localTransform.f)},t.prototype.getLocalPoint=function(t,e){return J.Matrix2d.invert(this.worldTransform).transformPoint({x:t,y:e})},t.prototype.childAt=function(t){return this._children[t]},t.prototype.forEachChild=function(t){this._children.forEach(t)},t.prototype.addChild=function(t){null===t._parent&&(t._parent=this,t._view=this._view,this._children.push(t))},t.prototype.removeChild=function(t){if(t._parent===this){var e=this._children.indexOf(t);this.removeChildAt(e)}},t.prototype.removeChildAt=function(t){if(0<=t&&t<this._children.length){var e=this._children[t];this._children.splice(t,1),e._parent=null,e._view=null}},t.prototype.removeChildren=function(){for(;0<this._children.length;)this.removeChildAt(0)},t.prototype.unrefChildren=function(){for(;0<this._children.length;)this._children[0].unrefChildren(),this.removeChildAt(0)},t.prototype.remove=function(){this._parent&&this._parent.removeChild(this)},t.prototype.triggerRecursive=function(n){e.prototype.trigger.call(this,n),this.forEachChild(function(t,e){t.triggerRecursive(n)})},t.prototype.triggerRecursiveEx=function(n){e.prototype.triggerEx.call(this,n),this.forEachChild(function(t,e){t.triggerRecursiveEx(n)})},t.prototype.setCapture=function(){this._view&&this._view.setCaptureObject(this)},t.prototype.releaseCapture=function(){this._view&&this._view.captureObject===this&&this._view.setCaptureObject(null)},t.prototype.toString=function(){return"<SceneObject>"},t}(e.BaseObject=U);e.SceneObject=q;var W=function(r){function t(t,e){void 0===e&&(e=!1);var o=r.call(this)||this;o._canvas=new X(o,t,e),o._captureObject=null,o._hitObjects=[],o._currentPage=null,o._pages={};var n=new q;return(n.view=o).addPage({name:"page1",rootNode:n,bkImageUrl:null,bkImageRepeat:null,bkImageSize:null,bkImageAttachment:null,bkColor:"#ffffff"}),o.selectPage("page1"),o.on(y.type,function(t){var e=new h(t.deltaTime,t.elapsedTime,t.frameStamp);o.rootNode&&o.rootNode.triggerRecursiveEx(e),o.canvas.clear(),o.triggerEx(new f(o.canvas,0,new J.Matrix2d)),o.canvas.flip()}),o.on(f.type,function(t){if(o.rootNode){var e=new l(t.canvas.width,t.canvas.height);for(var n in o.rootNode.triggerRecursiveEx(e),e.result)for(var r=e.result[n],i=0;i<r.length;i++)t.canvas.context.save(),t.canvas.applyTransform(r[i].transform),t.canvas.context.translate(.5,.5),r[i].object.triggerEx(new f(t.canvas,r[i].z,r[i].transform)),t.canvas.context.restore()}}),o}return p(t,r),t.prototype.forEachPage=function(t){if(t)for(var e in this._pages)t({name:e,rootNode:this._pages[e].rootNode,bkImageUrl:this._pages[e].bkImageUrl,bkImageRepeat:this._pages[e].bkImageRepeat,bkImageAttachment:this._pages[e].bkImageAttachment,bkImageSize:this._pages[e].bkImageSize,bkColor:this._pages[e].bkColor})},t.prototype.addPage=function(t){var e={name:null,rootNode:null,bkImageUrl:null,bkImageRepeat:"repeat",bkImageAttachment:"scroll",bkImageSize:"auto",bkColor:"#ffffff"},n=t||e,r=n.name||this.genPageName();return r in this._pages?null:(this._pages[r]={name:r,rootNode:n.rootNode,bkImageUrl:n.bkImageUrl,bkImageRepeat:n.bkImageRepeat||e.bkImageRepeat,bkImageAttachment:n.bkImageAttachment||e.bkImageAttachment,bkImageSize:n.bkImageSize||e.bkImageSize,bkColor:n.bkColor||e.bkColor},r)},t.prototype.removePage=function(t){if(t in this._pages){if(t===this._currentPage){var e=!1;for(var n in this._pages)n!==t&&(this.selectPage(n),e=!0);if(!e)return!1}var r=this._pages[t].rootNode;return r&&(r.unrefChildren(),r.view=null,this._pages[t].rootNode=null),delete this._pages[t],!0}return!1},t.prototype.selectPage=function(t){var e=this._currentPage;t in this._pages&&t!==e&&(N.triggerEvent(null,new K(this,e,t)),this._currentPage=t,this._captureObject=null,this._hitObjects.length=0,this.applyPage(this._pages[this._currentPage]),N.triggerEvent(null,new F(this,e,t)))},t.prototype.renamePage=function(t,e){if(t in this._pages&&e&&e!==t&&!(e in this._pages)){var n=this._pages[t];delete this._pages[t],n.name=e,this._pages[e]=n,t===this._currentPage&&(this._currentPage=e)}},Object.defineProperty(t.prototype,"currentPage",{get:function(){return this._currentPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageImage",{get:function(){return this._currentPage?this._pages[this._currentPage].bkImageUrl:null},set:function(t){this._currentPage&&t!==this._pages[this._currentPage].bkImageUrl&&(this._pages[this._currentPage].bkImageUrl=t,this.applyPage(this._pages[this._currentPage]))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageImageRepeat",{get:function(){return this._currentPage?this._pages[this._currentPage].bkImageRepeat:null},set:function(t){var e=t||"repeat";this._currentPage&&e!==this._pages[this._currentPage].bkImageRepeat&&(this._pages[this._currentPage].bkImageRepeat=e,this.applyPage(this._pages[this._currentPage]))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageImageAttachment",{get:function(){return this._currentPage?this._pages[this._currentPage].bkImageAttachment:null},set:function(t){var e=t||"scroll";this._currentPage&&e!==this._pages[this._currentPage].bkImageAttachment&&(this._pages[this._currentPage].bkImageAttachment=e,this.applyPage(this._pages[this._currentPage]))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageImageSize",{get:function(){return this._currentPage?this._pages[this._currentPage].bkImageSize:null},set:function(t){var e=t||"auto";this._currentPage&&e!==this._pages[this._currentPage].bkImageSize&&(this._pages[this._currentPage].bkImageSize=e,this.applyPage(this._pages[this._currentPage]))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageColor",{get:function(){return this._currentPage?this._pages[this._currentPage].bkColor:null},set:function(t){this._currentPage&&t!==this._pages[this._currentPage].bkColor&&(this._pages[this._currentPage].bkColor=t,this.applyPage(this._pages[this._currentPage]))},enumerable:!0,configurable:!0}),t.prototype.updateHitObjects=function(t,e){for(var n=this.hitTest(t,e),r=0;r<this._hitObjects.length;)n.indexOf(this._hitObjects[r])<0?(this._hitObjects[r].trigger(new O),this._hitObjects.splice(r,1)):r++;for(r=0;r<n.length;r++)this._hitObjects.indexOf(n[r])<0&&n[r].trigger(new S);this._hitObjects=n,this.rootNode&&this._hitObjects.push(this.rootNode)},Object.defineProperty(t.prototype,"rootNode",{get:function(){if(this._currentPage){var t=this._pages[this._currentPage].rootNode;return t||(((t=new q).view=this)._pages[this._currentPage].rootNode=t),t}return null},set:function(t){this._currentPage&&this._pages[this._currentPage].rootNode!==t&&(this._pages[this._currentPage].rootNode=t,this._hitObjects.length=0,this._captureObject=null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"captureObject",{get:function(){return this._captureObject},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hitObjects",{get:function(){return this._hitObjects},enumerable:!0,configurable:!0}),t.prototype.setCaptureObject=function(t){this._captureObject=t},t.prototype.handleMouseDown=function(t){var e=this.canvas.viewport_rect,n=new x(t.clientX-e.x,t.clientY-e.y,t.button,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey);if(this.isValidObject(this._captureObject))this._captureObject.triggerEx(n);else{for(var r=0;r<this._hitObjects.length;r++){var i=this._hitObjects[r];if(this.isValidObject(i)&&(i.triggerEx(n),!n.bubble))break}n.bubble&&this.triggerEx(n)}},t.prototype.handleMouseUp=function(t){var e=this.canvas.viewport_rect,n=new P(t.clientX-e.x,t.clientY-e.y,t.button,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey);if(this.isValidObject(this._captureObject))this._captureObject.triggerEx(n);else{for(var r=0;r<this._hitObjects.length;r++){var i=this._hitObjects[r];if(this.isValidObject(i)&&(i.triggerEx(n),!n.bubble))break}n.bubble&&this.triggerEx(n)}},t.prototype.handleMouseMove=function(t){var e=this.canvas.viewport_rect,n=new E(t.clientX-e.x,t.clientY-e.y,t.button,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey);if(this.isValidObject(this._captureObject))this._captureObject.triggerEx(n);else{for(var r=0;r<this._hitObjects.length;r++){var i=this._hitObjects[r];if(this.isValidObject(i)&&(i.triggerEx(n),!n.bubble))break}n.bubble&&this.triggerEx(n)}},t.prototype.handleClick=function(t){for(var e=this.canvas.viewport_rect,n=new j(t.clientX-e.x,t.clientY-e.y,t.button,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey),r=0;r<this._hitObjects.length;r++){var i=this._hitObjects[r];if(this.isValidObject(i)&&(i.triggerEx(n),!n.bubble))break}n.bubble&&this.triggerEx(n)},t.prototype.handleDblClick=function(t){for(var e=this.canvas.viewport_rect,n=new T(t.clientX-e.x,t.clientY-e.y,t.button,t.shiftKey,t.altKey,t.ctrlKey,t.metaKey),r=0;r<this._hitObjects.length;r++){var i=this._hitObjects[r];if(this.isValidObject(i)&&(i.triggerEx(n),!n.bubble))break}n.bubble&&this.triggerEx(n)},t.prototype.setFocus=function(){N.setFocusView(this)},t.prototype.hitTest=function(o,a){var t=[];return this.rootNode&&(!function n(t,r){var e=J.Matrix2d.invert(t.worldTransform).transformPoint({x:o,y:a}),i=new g(e.x,e.y);t.triggerEx(i),i.result&&r.push(t),t.forEachChild(function(t,e){n(t,r)})}(this.rootNode,t),t.sort(function(t,e){return e.z-t.z})),t},t.prototype.isValidObject=function(t){return t&&t.view===this},t.prototype.genPageName=function(){for(var t=1;;){var e="page"+t++;if(!(e in this._pages))return e}},t.prototype.applyPage=function(t){var e=t.bkColor||"",n=t.bkImageUrl&&"url("+t.bkImageUrl+")"||"",r=t.bkImageRepeat||"repeat",i=t.bkImageAttachment||"scroll",o=t.bkImageSize||"auto";this._canvas.canvas.style.background=e+" "+n+" "+r+" "+i+" 0% 0% / "+o},t}(U);function Y(r,i){var t=parseInt(window.getComputedStyle(r).zIndex||"0",10);isNaN(t)&&(t=0),t--;var e=document.createElement("div");e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.right="0px",e.style.bottom="0px",e.style.overflow="hidden",e.style.zIndex=String(t),e.style.visibility="hidden";var n=document.createElement("div");n.style.position="absolute",n.style.left="0px",n.style.top="0px",n.style.width="10000000px",n.style.height="10000000px",e.appendChild(n);var o=document.createElement("div");o.style.position="absolute",o.style.left="0px",o.style.top="0px",o.style.right="0px",o.style.bottom="0px",o.style.overflow="hidden",o.style.zIndex=String(t),o.style.visibility="hidden";var a=document.createElement("div");function s(){e.scrollLeft=1e7,e.scrollTop=1e7,o.scrollLeft=1e7,o.scrollTop=1e7}a.style.position="absolute",a.style.left="0px",a.style.top="0px",a.style.width="200%",a.style.height="200%",o.appendChild(a),r.appendChild(e),r.appendChild(o),s();var u=r.getBoundingClientRect(),c=u.width,h=u.height,l=function(){var t=r.getBoundingClientRect(),e=t.width,n=t.height;e===c&&n===h||(c=e,h=n,i()),s()};e.addEventListener("scroll",l),o.addEventListener("scroll",l)}e.SceneView=W,e.ResizeSensor=Y;var X=function(i){function t(t,e,n){void 0===n&&(n=!1);var r=i.call(this)||this;return r._view=t,r._canvas=e,r._buffer=null,r._screenCtx=null,r._offscreenCtx=null,r._width=0,r._height=0,r._canvas&&(r.adjustCanvasSize(r._canvas),r._canvas.parentElement&&Y(r._canvas.parentElement,function(){r.adjustCanvasSize(r._canvas)})),r._mouseOver=!1,r._doubleBuffer=n,r}return p(t,i),Object.defineProperty(t.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._doubleBuffer?this._offscreenCtx:this._screenCtx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewport_rect",{get:function(){var t=this._canvas.getBoundingClientRect();return{x:t.left-document.documentElement.clientLeft,y:t.top-document.documentElement.clientTop,w:t.right-t.left,h:t.bottom-t.top}},enumerable:!0,configurable:!0}),t.prototype.clear=function(t){var e=t?t.x:0,n=t?t.y:0,r=t?t.w:this._width,i=t?t.h:this._height;this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(e,n,r,i),this._doubleBuffer&&this._screenCtx&&this._screenCtx.clearRect(e,n,r,i)},t.prototype.applyTransform=function(t){this.context.setTransform(t.a,t.b,t.c,t.d,Math.round(t.e),Math.round(t.f))},t.prototype.flip=function(){this._doubleBuffer&&this._screenCtx&&this._buffer&&this._screenCtx.drawImage(this._buffer,0,0)},t.prototype.adjustCanvasSize=function(t){if(t.parentElement){var e=window.getComputedStyle(t.parentElement);this._width=t.parentElement.clientWidth-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight),this._height=t.parentElement.clientHeight-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom),this._canvas.width=this._width,this._canvas.height=this._height,this._screenCtx=this._canvas.getContext("2d"),this._buffer=document.createElement("canvas"),this._buffer.width=this._width,this._buffer.height=this._height,this._offscreenCtx=this._buffer.getContext("2d"),N.triggerEvent(null,new L(this._view))}},t}(U);e.Canvas=X});e(l);l.EventListenerOrder,l.BaseEvent,l.EvtComponentBeforeAttach,l.EvtComponentAttached,l.EvtComponentBeforeDetach,l.EvtComponentDetached,l.EvtUpdate,l.EvtCull,l.EvtDraw,l.EvtHitTest,l.EvtGetBoundingShape,l.EvtFrame,l.EvtFocus,l.EvtKeyboard,l.EvtKeyDown,l.EvtKeyUp,l.EvtKeyPress,l.EvtMouse,l.EvtMouseDown,l.EvtMouseUp,l.EvtMouseMove,l.EvtMouseEnter,l.EvtMouseLeave,l.EvtClick,l.EvtDblClick,l.EvtDragBegin,l.EvtDragEnd,l.EvtDragging,l.EvtDragOver,l.EvtDragDrop,l.EvtResize,l.EvtCanvasResize,l.EvtGetProp,l.EvtSetProp,l.EvtSceneViewPageWillChange,l.EvtSceneViewPageChanged,l.EvtSysInfo,l.EventObserver,l.App,l.Component,l.BaseObject,l.SceneObject,l.SceneView,l.ResizeSensor,l.Canvas;var i=n(function(t,e){var r,n=Q&&Q.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(s){function u(t){var o=s.call(this,u.type)||this;o._tracks={},o._duration=0,o._startTime=0,o._round=0;var e=t||{};if(o._delay=void 0===e.delay?0:e.delay,o._repeat=void 0===e.repeat?0:e.repeat,o._autoRemove=void 0===e.autoRemove||e.autoRemove,o._exclusive=!!e.exclusive,e.tracks)for(var n in e.tracks)if(e.tracks.hasOwnProperty(n)){var r=e.tracks[n],i=void 0===r.type?h.SplineType.POLY:r.type,a=void 0===r.clamp||r.clamp;o.setTrack(n,i,a,r.cp)}return o.on(l.EvtComponentBeforeAttach.type,function(t){t.object&&o._exclusive&&t.object.removeComponentsByType(o.type)}),o.on(l.EvtUpdate.type,function(t){var e=t.elapsedTime;if(0===o._startTime&&(o._startTime=e),!(o._startTime+o._delay>e)){var n=e-o._startTime-o._delay;for(var r in o._tracks)o._tracks.hasOwnProperty(r)&&(o._tracks[r].value=o._tracks[r].evalutor.eval(n));if(o.object)for(var i in o._tracks)o._tracks.hasOwnProperty(i)&&o.object.triggerEx(new l.EvtSetProp(i,o._tracks[i].value));n>=o._duration&&(o._round++,0===o._repeat||o._round<o._repeat?o._startTime=e+n-o._duration:o._autoRemove&&o.object&&o.object.removeComponent(o))}}),o}return n(u,s),Object.defineProperty(u.prototype,"repeat",{get:function(){return this._repeat},set:function(t){this._repeat=t},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"autoRemove",{get:function(){return this._autoRemove},set:function(t){this._autoRemove=t},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"delay",{get:function(){return this._delay},set:function(t){this._delay=t},enumerable:!0,configurable:!0}),u.prototype.setTrack=function(t,e,n,r){0<r.length&&(r[r.length-1].x>this._duration&&(this._duration=r[r.length-1].x),this._tracks[t]={evalutor:new h.Spline(e,r,n),value:null})},u.prototype.finish=function(){for(var t in this._tracks)this._tracks[t].value=this._tracks[t].evalutor.evalLast();if(this.object)for(var e in this._tracks)this.object.triggerEx(new l.EvtSetProp(e,this._tracks[e].value));this._round++,0===this._repeat||this._round<this._repeat?this._startTime=l.App.elapsedTime:this._autoRemove&&this.object&&this.object.removeComponent(this)},u.type="KeyframeAnimation",u}(l.Component);e.CoKeyframeAnimation=i;var o=function(t){function e(){var a=t.call(this,e.type)||this;return a._dragging=!1,a._draggingData=null,a.on(l.EvtMouseDown.type,function(t){var e=a.object;e.setCapture(),a._dragging=!0;var n=new l.EvtDragBegin(t.x,t.y,t.button,t.shiftDown,t.altDown,t.ctrlDown,t.metaDown);e.triggerEx(n),a._draggingData=n.data,t.cancelBubble()}),a.on(l.EvtMouseUp.type,function(t){var e=a.object;if(e.releaseCapture(),e.view&&a._dragging){var n=new l.EvtDragEnd(t.x,t.y,t.button,t.shiftDown,t.altDown,t.ctrlDown,t.metaDown,a._draggingData);e.triggerEx(n),a._dragging=!1,e.view.updateHitObjects(t.x,t.y);for(var r=new l.EvtDragDrop(t.x,t.y,t.button,t.shiftDown,t.altDown,t.ctrlDown,t.metaDown,e,a._draggingData),i=0;i<e.view.hitObjects.length;i++){var o=e.view.hitObjects[i];if(o!==e&&o.z<=e.z&&(o.triggerEx(r),!r.bubble))break}r.bubble&&e.view.triggerEx(r),a._draggingData=null,t.cancelBubble()}}),a.on(l.EvtMouseMove.type,function(t){if(a.object&&a._dragging){var e=new l.EvtDragging(t.x,t.y,t.button,t.shiftDown,t.altDown,t.ctrlDown,t.metaDown,a._draggingData);a.object.triggerEx(e);var n=a.object;if(n.view){n.view.updateHitObjects(t.x,t.y);for(var r=new l.EvtDragOver(t.x,t.y,t.button,t.shiftDown,t.altDown,t.ctrlDown,t.metaDown,n,a._draggingData),i=0;i<n.view.hitObjects.length;i++){var o=n.view.hitObjects[i];if(o!==n&&o.z<=n.z&&(o.triggerEx(r),!r.bubble))break}r.bubble&&n.view.triggerEx(r),t.cancelBubble()}}}),a}return n(e,t),e.type="Draggable",e}(l.Component);e.CoDraggable=o;var a=function(t){function e(){return t.call(this,e.type)||this}return n(e,t),e.type="Droppable",e}(l.Component);e.CoDroppable=a;var s=function(i){function o(t,e,n){void 0===t&&(t=null),void 0===e&&(e=0),void 0===n&&(n=0);var r=i.call(this,o.type)||this;return r._image=new Image,t&&(r._image.src=t),r._width=e?r._image.width=e:r._image.complete?r._image.width:0,r._height=n?r._image.height=n:r._image.complete?r._image.height:0,r._image.complete?r._loaded=!0:(r._loaded=!1,r._image.onload=function(){0===r._width&&(r._width=r._image.width),0===r._height&&(r._height=r._image.height),r._loaded=!0}),r.on(l.EvtCull.type,function(t){if(r._loaded){var e=r.object;t.addObject(r,e.z,e.worldTransform)}}),r.on(l.EvtGetBoundingShape.type,function(t){r.object&&r._loaded&&(t.shape=new _.BoundingBox({x:-r._width*r.object.anchorPoint.x,y:-r._height*r.object.anchorPoint.y,w:r._width,h:r._height}))}),r.on(l.EvtDraw.type,function(t){r.object&&r._loaded&&t.canvas.context.drawImage(r._image,-Math.round(r._width*r.object.anchorPoint.x)-.5,-Math.round(r._height*r.object.anchorPoint.y)-.5,r._width,r._height)}),r.on(l.EvtGetProp.type,function(t){switch(t.propName){case"width":t.propValue=r._width,t.eat();break;case"height":t.propValue=r._height,t.eat()}}),r.on(l.EvtSetProp.type,function(t){switch(t.propName){case"width":r._width=t.propValue,r._image.width=r._width,t.eat();break;case"height":r._height=t.propValue,r._image.height=r._height,t.eat()}}),r}return n(o,i),o.type="Image",o}(l.Component);e.CoImage=s});e(i);i.CoKeyframeAnimation,i.CoDraggable,i.CoDroppable,i.CoImage;var a=n(function(t,e){function k(t,e,n,r,i,o,a,s){var u=4*(i*e+r);t[u]=o,t[u+1]=a,t[u+2]=s,t[u+3]=255}Object.defineProperty(e,"__esModule",{value:!0});var y=null;function p(t){for(var e={r:255,g:255,b:255,a:255},n=[],r=0,i=(t.toLowerCase(),"0".charCodeAt(0)),o="9".charCodeAt(0),a="a".charCodeAt(0),s="f".charCodeAt(0),u=1;u<t.length;u++){var c=t.charCodeAt(u),h=0;i<=c&&c<=o?h=c-i:a<=c&&c<=s&&(h=10+c-a),u%2==1?r=h:n.push(16*r+h)}return 0<n.length&&(e.r=n[0]),1<n.length&&(e.g=n[1]),2<n.length&&(e.b=n[2]),3<n.length&&(e.a=n[3]),e}e.DrawLine=function(t,e,n,r,i,o){var a=p(o),s=r<e?r:e,u=i<n?i:n,c=r<e?e:r,h=i<n?n:i,l=t.getImageData(s,u,c-s+1,h-u+1);!function(t,e,n,r,i,o,a,s,u,c){var h,l=Math.abs(o-r),p=Math.abs(a-i),f=0;l<p&&(f=1,h=r,r=i,i=h,h=o,o=a,a=h,h=l,l=p,p=h);var g=r<o?1:-1,d=i<a?1:-1,y=r,v=i,_=2*p,m=2*(p-l),b=2*p-l;if(1===f)for(;y!==o;)b<0?b+=_:(v+=d,b+=m),k(t,e,0,v,y,s,u,c),y+=g;else for(;y!==o;)b<0?b+=_:(v+=d,b+=m),k(t,e,0,y,v,s,u,c),y+=g}(l.data,l.width,l.height,e-s,n-u,r-s,i-u,a.r,a.g,a.b),t.putImageData(l,s,u)},e.FillCircle=function(t,e,n,r,i){var o=p(i),a=t.getImageData(e-r,n-r,2*r+1,2*r+1);!function(t,s,e,u,c,h,l,p,f){function n(t,e){var n=y,r=t-u,i=e-c,o=1-Math.sqrt((r*r+i*i)/(h*h)),a=4*(e*s+t);n[a]=l*o,n[a+1]=p*o,n[a+2]=f*o,n[a+3]=255*o}(null===y||y.length<t.length)&&(y=new Uint8ClampedArray(t.length));var r,i=0,o=h,a=3,g=2-h-h,d=1-h;for(n(i+u,o+c),n(i+u,-o+c),r=-h+u;r<=h+u;r++)n(r,c);for(;i<o;){for(d<0?(d+=a,a+=2,i++):(d+=a+g,a+=2,g+=2,i++,o--),r=-i+u;r<=i+u;r++)n(r,-o+c),n(r,o+c);for(r=-o+u;r<=o+u;r++)n(r,-i+c),n(r,i+c)}!function(t,e){for(var n=0;n<t.length/4;n++){var r=1-e[4*n+3]/255;t[4*n]=t[4*n]*r+e[4*n],t[4*n+1]=t[4*n+1]*r+e[4*n+1],t[4*n+2]=t[4*n+2]*r+e[4*n+2],t[4*n+3]<e[4*n+3]&&(t[4*n+3]=e[4*n+3])}}(t,y)}(a.data,a.width,a.height,r,r,r,o.r,o.g,o.b),t.putImageData(a,e-r,n-r)}});e(a);a.DrawLine,a.FillCircle;var p=n(function(t,n){function e(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0}),e(y),e(o),e(_),e(v),e(m),e(b),e(Z),e(h),e(r),e(J),e(l),e(i),e(a)});e(p);var s=n(function(t,e){var r,i=Q&&Q.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(n){function r(t){var e=n.call(this,r.type)||this;return e.cmd=t,e}return i(r,n),r.type="@postCommand",r}(p.BaseEvent);e.EvtPostCommand=n;var o=function(n){function r(t){var e=n.call(this,r.type)||this;return e.cmd=t,e}return i(r,n),r.type="@receiveCommand",r}(p.BaseEvent);e.EvtReceiveCommand=o;var a=function(e){function t(){var t=e.call(this)||this;return t._started=!1,t}return i(t,e),t.prototype.start=function(){!this._started&&this._start()&&(this._started=!0)},t.prototype.stop=function(){this._started&&this._stop()&&(this._started=!1)},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t}(p.EventObserver),s=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype._start=function(){return this.on(n.type,function(t){t.cmd&&p.App.triggerEvent(null,new o(t.cmd))}),!0},e.prototype._stop=function(){return this.off(n.type),!0},e}(a);e.LocalCommandServer=s;var u=function(n){function t(t){var e=n.call(this)||this;return e._uri=t,e._socket=null,e}return i(t,n),t.prototype._start=function(){var e=this;return this._socket=c(this._uri,{transports:["websocket"],reconnection:!1}),this._socket.on("connect",function(){e.onConnect()}),this._socket.on("event",function(t){e.onEvent(t)}),this._socket.on("disconnect",function(){e.onDisconnect()}),!0},t.prototype._stop=function(){return this._socket&&this._socket.close(),!0},t.prototype.onConnect=function(){console.log("connected")},t.prototype.onEvent=function(t){console.log("event")},t.prototype.onDisconnect=function(){console.log("disconnect")},t}(a);e.SocketCommandServer=u});e(s);s.EvtPostCommand,s.EvtReceiveCommand,s.LocalCommandServer,s.SocketCommandServer;var u=n(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.init=function(t){new s.SocketCommandServer(t).start()}}),f=e(u),g=u.init;t.default=f,t.init=g,Object.defineProperty(t,"__esModule",{value:!0})});
