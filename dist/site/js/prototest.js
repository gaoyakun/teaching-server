!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.prototest={})}(this,function(exports){"use strict";var commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function unwrapExports(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function createCommonjsModule(t,e){return t(e={exports:{}},e.exports),e.exports}var aspromise=asPromise;function asPromise(t,e){for(var r=new Array(arguments.length-1),o=0,n=2,s=!0;n<arguments.length;)r[o++]=arguments[n++];return new Promise(function(n,i){r[o]=function(t){if(s)if(s=!1,t)i(t);else{for(var e=new Array(arguments.length-1),r=0;r<e.length;)e[r++]=arguments[r];n.apply(null,e)}};try{t.apply(e||null,r)}catch(t){s&&(s=!1,i(t))}})}var base64_1=createCommonjsModule(function(t,e){var r=e;r.length=function(t){var e=t.length;if(!e)return 0;for(var r=0;1<--e%4&&"="===t.charAt(e);)++r;return Math.ceil(3*t.length)/4-r};for(var f=new Array(64),a=new Array(123),n=0;n<64;)a[f[n]=n<26?n+65:n<52?n+71:n<62?n-4:n-59|43]=n++;r.encode=function(t,e,r){for(var n,i=null,o=[],s=0,u=0;e<r;){var a=t[e++];switch(u){case 0:o[s++]=f[a>>2],n=(3&a)<<4,u=1;break;case 1:o[s++]=f[n|a>>4],n=(15&a)<<2,u=2;break;case 2:o[s++]=f[n|a>>6],o[s++]=f[63&a],u=0}8191<s&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return u&&(o[s++]=f[n],o[s++]=61,1===u&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var l="invalid encoding";r.decode=function(t,e,r){for(var n,i=r,o=0,s=0;s<t.length;){var u=t.charCodeAt(s++);if(61===u&&1<o)break;if(void 0===(u=a[u]))throw Error(l);switch(o){case 0:n=u,o=1;break;case 1:e[r++]=n<<2|(48&u)>>4,n=u,o=2;break;case 2:e[r++]=(15&n)<<4|(60&u)>>2,n=u,o=3;break;case 3:e[r++]=(3&n)<<6|u,o=0}}if(1===o)throw Error(l);return r-i},r.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}}),eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(t,e,r){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:r||this}),this},EventEmitter.prototype.off=function(t,e){if(void 0===t)this._listeners={};else if(void 0===e)this._listeners[t]=[];else for(var r=this._listeners[t],n=0;n<r.length;)r[n].fn===e?r.splice(n,1):++n;return this},EventEmitter.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<e.length;)e[n].fn.apply(e[n++].ctx,r)}return this};var float_1=factory(factory);function factory(u){return"undefined"!=typeof Float32Array?function(){var n=new Float32Array([-0]),i=new Uint8Array(n.buffer),t=128===i[3];function e(t,e,r){n[0]=t,e[r]=i[0],e[r+1]=i[1],e[r+2]=i[2],e[r+3]=i[3]}function r(t,e,r){n[0]=t,e[r]=i[3],e[r+1]=i[2],e[r+2]=i[1],e[r+3]=i[0]}function o(t,e){return i[0]=t[e],i[1]=t[e+1],i[2]=t[e+2],i[3]=t[e+3],n[0]}function s(t,e){return i[3]=t[e],i[2]=t[e+1],i[1]=t[e+2],i[0]=t[e+3],n[0]}u.writeFloatLE=t?e:r,u.writeFloatBE=t?r:e,u.readFloatLE=t?o:s,u.readFloatBE=t?s:o}():function(){function t(t,e,r,n){var i=e<0?1:0;if(i&&(e=-e),0===e)t(0<1/e?0:2147483648,r,n);else if(isNaN(e))t(2143289344,r,n);else if(34028234663852886e22<e)t((i<<31|2139095040)>>>0,r,n);else if(e<11754943508222875e-54)t((i<<31|Math.round(e/1401298464324817e-60))>>>0,r,n);else{var o=Math.floor(Math.log(e)/Math.LN2);t((i<<31|o+127<<23|8388607&Math.round(e*Math.pow(2,-o)*8388608))>>>0,r,n)}}function e(t,e,r){var n=t(e,r),i=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:i*(1/0):0===o?1401298464324817e-60*i*s:i*Math.pow(2,o-150)*(s+8388608)}u.writeFloatLE=t.bind(null,writeUintLE),u.writeFloatBE=t.bind(null,writeUintBE),u.readFloatLE=e.bind(null,readUintLE),u.readFloatBE=e.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var n=new Float64Array([-0]),i=new Uint8Array(n.buffer),t=128===i[7];function e(t,e,r){n[0]=t,e[r]=i[0],e[r+1]=i[1],e[r+2]=i[2],e[r+3]=i[3],e[r+4]=i[4],e[r+5]=i[5],e[r+6]=i[6],e[r+7]=i[7]}function r(t,e,r){n[0]=t,e[r]=i[7],e[r+1]=i[6],e[r+2]=i[5],e[r+3]=i[4],e[r+4]=i[3],e[r+5]=i[2],e[r+6]=i[1],e[r+7]=i[0]}function o(t,e){return i[0]=t[e],i[1]=t[e+1],i[2]=t[e+2],i[3]=t[e+3],i[4]=t[e+4],i[5]=t[e+5],i[6]=t[e+6],i[7]=t[e+7],n[0]}function s(t,e){return i[7]=t[e],i[6]=t[e+1],i[5]=t[e+2],i[4]=t[e+3],i[3]=t[e+4],i[2]=t[e+5],i[1]=t[e+6],i[0]=t[e+7],n[0]}u.writeDoubleLE=t?e:r,u.writeDoubleBE=t?r:e,u.readDoubleLE=t?o:s,u.readDoubleBE=t?s:o}():function(){function t(t,e,r,n,i,o){var s=n<0?1:0;if(s&&(n=-n),0===n)t(0,i,o+e),t(0<1/n?0:2147483648,i,o+r);else if(isNaN(n))t(0,i,o+e),t(2146959360,i,o+r);else if(17976931348623157e292<n)t(0,i,o+e),t((s<<31|2146435072)>>>0,i,o+r);else{var u;if(n<22250738585072014e-324)t((u=n/5e-324)>>>0,i,o+e),t((s<<31|u/4294967296)>>>0,i,o+r);else{var a=Math.floor(Math.log(n)/Math.LN2);1024===a&&(a=1023),t(4503599627370496*(u=n*Math.pow(2,-a))>>>0,i,o+e),t((s<<31|a+1023<<20|1048576*u&1048575)>>>0,i,o+r)}}}function e(t,e,r,n,i){var o=t(n,i+e),s=t(n,i+r),u=2*(s>>31)+1,a=s>>>20&2047,f=4294967296*(1048575&s)+o;return 2047===a?f?NaN:u*(1/0):0===a?5e-324*u*f:u*Math.pow(2,a-1075)*(f+4503599627370496)}u.writeDoubleLE=t.bind(null,writeUintLE,0,4),u.writeDoubleBE=t.bind(null,writeUintBE,4,0),u.readDoubleLE=e.bind(null,readUintLE,0,4),u.readDoubleBE=e.bind(null,readUintBE,4,0)}(),u}function writeUintLE(t,e,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function writeUintBE(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=255&t}function readUintLE(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function readUintBE(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}var utf8_1=createCommonjsModule(function(t,e){var r=e;r.length=function(t){for(var e=0,r=0,n=0;n<t.length;++n)(r=t.charCodeAt(n))<128?e+=1:r<2048?e+=2:55296==(64512&r)&&56320==(64512&t.charCodeAt(n+1))?(++n,e+=4):e+=3;return e},r.read=function(t,e,r){if(r-e<1)return"";for(var n,i=null,o=[],s=0;e<r;)n=t[e++],o[s++]=n<128?n:191<n&&n<224?(31&n)<<6|63&t[e++]:239<n&&n<365?(n=((7&n)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,o[s++]=55296+(n>>10),56320+(1023&n)):(15&n)<<12|(63&t[e++])<<6|63&t[e++],8191<s&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},r.write=function(t,e,r){for(var n,i,o=r,s=0;s<t.length;++s)n=t.charCodeAt(s),e[r++]=n<128?n:(e[r++]=n<2048?n>>6|192:(55296==(64512&n)&&56320==(64512&(i=t.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&i),++s,e[r++]=n>>18|240,e[r++]=n>>12&63|128):e[r++]=n>>12|224,n>>6&63|128),63&n|128);return r-o}}),pool_1=pool;function pool(r,n,t){var i=t||8192,o=i>>>1,s=null,u=i;return function(t){if(t<1||o<t)return r(t);i<u+t&&(s=r(i),u=0);var e=n.call(s,u,u+=t);return 7&u&&(u=1+(7|u)),e}}var longbits=LongBits;function LongBits(t,e){this.lo=t>>>0,this.hi=e>>>0}var zero=LongBits.zero=new LongBits(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits.zeroHash="\0\0\0\0\0\0\0\0";LongBits.fromNumber=function(t){if(0===t)return zero;var e=t<0;e&&(t=-t);var r=t>>>0,n=(t-r)/4294967296>>>0;return e&&(n=~n>>>0,r=~r>>>0,4294967295<++r&&(r=0,4294967295<++n&&(n=0))),new LongBits(r,n)},LongBits.from=function(t){if("number"==typeof t)return LongBits.fromNumber(t);if(minimal.isString(t)){if(!minimal.Long)return LongBits.fromNumber(parseInt(t,10));t=minimal.Long.fromString(t)}return t.low||t.high?new LongBits(t.low>>>0,t.high>>>0):zero},LongBits.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=1+~this.lo>>>0,r=~this.hi>>>0;return e||(r=r+1>>>0),-(e+4294967296*r)}return this.lo+4294967296*this.hi},LongBits.prototype.toLong=function(t){return minimal.Long?new minimal.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var charCodeAt=String.prototype.charCodeAt;LongBits.fromHash=function(t){return t===zeroHash?zero:new LongBits((charCodeAt.call(t,0)|charCodeAt.call(t,1)<<8|charCodeAt.call(t,2)<<16|charCodeAt.call(t,3)<<24)>>>0,(charCodeAt.call(t,4)|charCodeAt.call(t,5)<<8|charCodeAt.call(t,6)<<16|charCodeAt.call(t,7)<<24)>>>0)},LongBits.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},LongBits.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},LongBits.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:r<128?9:10};var minimal=createCommonjsModule(function(t,e){var n=e;function i(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)void 0!==t[n[i]]&&r||(t[n[i]]=e[n[i]]);return t}function r(t){function r(t,e){if(!(this instanceof r))return new r(t,e);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,r):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),e&&i(this,e)}return(r.prototype=Object.create(Error.prototype)).constructor=r,Object.defineProperty(r.prototype,"name",{get:function(){return t}}),r.prototype.toString=function(){return this.name+": "+this.message},r}n.asPromise=aspromise,n.base64=base64_1,n.EventEmitter=eventemitter,n.float=float_1,n.inquire=inquire_1,n.utf8=utf8_1,n.pool=pool_1,n.LongBits=longbits,n.global="undefined"!=typeof window&&window||void 0!==commonjsGlobal&&commonjsGlobal||"undefined"!=typeof self&&self||commonjsGlobal,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isNode=Boolean(n.global.process&&n.global.process.versions&&n.global.process.versions.node),n.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},n.isString=function(t){return"string"==typeof t||t instanceof String},n.isObject=function(t){return t&&"object"==typeof t},n.isset=n.isSet=function(t,e){var r=t[e];return!(null==r||!t.hasOwnProperty(e))&&("object"!=typeof r||0<(Array.isArray(r)?r.length:Object.keys(r).length))},n.Buffer=function(){try{var t=n.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(t){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(t){return"number"==typeof t?n.Buffer?n._Buffer_allocUnsafe(t):new n.Array(t):n.Buffer?n._Buffer_from(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(t){return t?n.LongBits.from(t).toHash():n.LongBits.zeroHash},n.longFromHash=function(t,e){var r=n.LongBits.fromHash(t);return n.Long?n.Long.fromBits(r.lo,r.hi,e):r.toNumber(Boolean(e))},n.merge=i,n.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},n.newError=r,n.ProtocolError=r("ProtocolError"),n.oneOfGetter=function(t){for(var r={},e=0;e<t.length;++e)r[t[e]]=1;return function(){for(var t=Object.keys(this),e=t.length-1;-1<e;--e)if(1===r[t[e]]&&void 0!==this[t[e]]&&null!==this[t[e]])return t[e]}},n.oneOfSetter=function(r){return function(t){for(var e=0;e<r.length;++e)r[e]!==t&&delete this[r[e]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var r=n.Buffer;r?(n._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,e){return new r(t,e)},n._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}}),writer=Writer,BufferWriter,LongBits$1=minimal.LongBits,base64=minimal.base64,utf8=minimal.utf8;function Op(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function noop(){}function State(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Writer(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}function writeByte(t,e,r){e[r]=255&t}function writeVarint32(t,e,r){for(;127<t;)e[r++]=127&t|128,t>>>=7;e[r]=t}function VarintOp(t,e){this.len=t,this.next=void 0,this.val=e}function writeVarint64(t,e,r){for(;t.hi;)e[r++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;127<t.lo;)e[r++]=127&t.lo|128,t.lo=t.lo>>>7;e[r++]=t.lo}function writeFixed32(t,e,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}Writer.create=minimal.Buffer?function(){return(Writer.create=function(){return new BufferWriter})()}:function(){return new Writer},Writer.alloc=function(t){return new minimal.Array(t)},minimal.Array!==Array&&(Writer.alloc=minimal.pool(Writer.alloc,minimal.Array.prototype.subarray)),Writer.prototype._push=function(t,e,r){return this.tail=this.tail.next=new Op(t,e,r),this.len+=e,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new VarintOp((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},Writer.prototype.int32=function(t){return t<0?this._push(writeVarint64,10,LongBits$1.fromNumber(t)):this.uint32(t)},Writer.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},Writer.prototype.uint64=function(t){var e=LongBits$1.from(t);return this._push(writeVarint64,e.length(),e)},Writer.prototype.int64=Writer.prototype.uint64,Writer.prototype.sint64=function(t){var e=LongBits$1.from(t).zzEncode();return this._push(writeVarint64,e.length(),e)},Writer.prototype.bool=function(t){return this._push(writeByte,1,t?1:0)},Writer.prototype.fixed32=function(t){return this._push(writeFixed32,4,t>>>0)},Writer.prototype.sfixed32=Writer.prototype.fixed32,Writer.prototype.fixed64=function(t){var e=LongBits$1.from(t);return this._push(writeFixed32,4,e.lo)._push(writeFixed32,4,e.hi)},Writer.prototype.sfixed64=Writer.prototype.fixed64,Writer.prototype.float=function(t){return this._push(minimal.float.writeFloatLE,4,t)},Writer.prototype.double=function(t){return this._push(minimal.float.writeDoubleLE,8,t)};var writeBytes=minimal.Array.prototype.set?function(t,e,r){e.set(t,r)}:function(t,e,r){for(var n=0;n<t.length;++n)e[r+n]=t[n]};Writer.prototype.bytes=function(t){var e=t.length>>>0;if(!e)return this._push(writeByte,1,0);if(minimal.isString(t)){var r=Writer.alloc(e=base64.length(t));base64.decode(t,r,0),t=r}return this.uint32(e)._push(writeBytes,e,t)},Writer.prototype.string=function(t){var e=utf8.length(t);return e?this.uint32(e)._push(utf8.write,e,t):this._push(writeByte,1,0)},Writer.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer.prototype.ldelim=function(){var t=this.head,e=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=t.next,this.tail=e,this.len+=r),this},Writer.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),r=0;t;)t.fn(t.val,e,r),r+=t.len,t=t.next;return e},Writer._configure=function(t){BufferWriter=t};var writer_buffer=BufferWriter$1;(BufferWriter$1.prototype=Object.create(writer.prototype)).constructor=BufferWriter$1;var Buffer=minimal.Buffer;function BufferWriter$1(){writer.call(this)}BufferWriter$1.alloc=function(t){return(BufferWriter$1.alloc=minimal._Buffer_allocUnsafe)(t)};var writeBytesBuffer=Buffer&&Buffer.prototype instanceof Uint8Array&&"set"===Buffer.prototype.set.name?function(t,e,r){e.set(t,r)}:function(t,e,r){if(t.copy)t.copy(e,r,0,t.length);else for(var n=0;n<t.length;)e[r++]=t[n++]};function writeStringBuffer(t,e,r){t.length<40?minimal.utf8.write(t,e,r):e.utf8Write(t,r)}BufferWriter$1.prototype.bytes=function(t){minimal.isString(t)&&(t=minimal._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push(writeBytesBuffer,e,t),this},BufferWriter$1.prototype.string=function(t){var e=Buffer.byteLength(t);return this.uint32(e),e&&this._push(writeStringBuffer,e,t),this};var reader=Reader,BufferReader,LongBits$2=minimal.LongBits,utf8$1=minimal.utf8;function indexOutOfRange(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Reader(t){this.buf=t,this.pos=0,this.len=t.length}var create_array="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new Reader(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new Reader(t);throw Error("illegal buffer")},Wf;function readLongVarint(){var t=new LongBits$2(0,0),e=0;if(!(4<this.len-this.pos)){for(;e<3;++e){if(this.pos>=this.len)throw indexOutOfRange(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,4<this.len-this.pos){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw indexOutOfRange(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function readFixed32_end(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits$2(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.create=minimal.Buffer?function(t){return(Reader.create=function(t){return minimal.Buffer.isBuffer(t)?new BufferReader(t):create_array(t)})(t)}:create_array,Reader.prototype._slice=minimal.Array.prototype.subarray||minimal.Array.prototype.slice,Reader.prototype.uint32=(Wf=4294967295,function(){if(Wf=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return Wf;if(Wf=(Wf|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return Wf;if(Wf=(Wf|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return Wf;if(Wf=(Wf|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return Wf;if(Wf=(Wf|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return Wf;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return Wf}),Reader.prototype.int32=function(){return 0|this.uint32()},Reader.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)|0},Reader.prototype.bool=function(){return 0!==this.uint32()},Reader.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var t=minimal.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},Reader.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var t=minimal.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},Reader.prototype.bytes=function(){var t=this.uint32(),e=this.pos,r=this.pos+t;if(r>this.len)throw indexOutOfRange(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(e,r):e===r?new this.buf.constructor(0):this._slice.call(this.buf,e,r)},Reader.prototype.string=function(){var t=this.bytes();return utf8$1.read(t,0,t.length)},Reader.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw indexOutOfRange(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},Reader._configure=function(t){BufferReader=t;var e=minimal.Long?"toLong":"toNumber";minimal.merge(Reader.prototype,{int64:function(){return readLongVarint.call(this)[e](!1)},uint64:function(){return readLongVarint.call(this)[e](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[e](!1)},fixed64:function(){return readFixed64.call(this)[e](!0)},sfixed64:function(){return readFixed64.call(this)[e](!1)}})};var reader_buffer=BufferReader$1;function BufferReader$1(t){reader.call(this,t)}(BufferReader$1.prototype=Object.create(reader.prototype)).constructor=BufferReader$1,minimal.Buffer&&(BufferReader$1.prototype._slice=minimal.Buffer.prototype.slice),BufferReader$1.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len))};var service=Service;function Service(t,e,r){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");minimal.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}(Service.prototype=Object.create(minimal.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function t(r,e,n,i,o){if(!i)throw TypeError("request must be specified");var s=this;if(!o)return minimal.asPromise(t,s,r,e,n,i);if(s.rpcImpl)try{return s.rpcImpl(r,e[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(t,e){if(t)return s.emit("error",t,r),o(t);if(null!==e){if(!(e instanceof n))try{e=n[s.responseDelimited?"decodeDelimited":"decode"](e)}catch(t){return s.emit("error",t,r),o(t)}return s.emit("data",e,r),o(null,e)}s.end(!0)})}catch(t){return s.emit("error",t,r),void setTimeout(function(){o(t)},0)}else setTimeout(function(){o(Error("already ended"))},0)},Service.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var rpc_1=createCommonjsModule(function(t,e){e.Service=service}),roots={},indexMinimal=createCommonjsModule(function(t,e){var r=e;function n(){r.Reader._configure(r.BufferReader),r.util._configure()}r.build="minimal",r.Writer=writer,r.BufferWriter=writer_buffer,r.Reader=reader,r.BufferReader=reader_buffer,r.util=minimal,r.rpc=rpc_1,r.roots=roots,r.configure=n,r.Writer._configure(r.BufferWriter),n()}),minimal$1=indexMinimal,$Reader=minimal$1.Reader,$Writer=minimal$1.Writer,$util=minimal$1.util,$root=minimal$1.roots.default||(minimal$1.roots.default={}),$g,fi,Ki,nj;$root.room=($g={},$g.JoinRoomMessage=function(){function e(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return e.prototype.account="",e.prototype.userId=0,e.create=function(t){return new e(t)},e.encode=function(t,e){return e||(e=$Writer.create()),null!=t.account&&t.hasOwnProperty("account")&&e.uint32(10).string(t.account),null!=t.userId&&t.hasOwnProperty("userId")&&e.uint32(16).uint32(t.userId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){t instanceof $Reader||(t=$Reader.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new $root.room.JoinRoomMessage;t.pos<r;){var i=t.uint32();switch(i>>>3){case 1:n.account=t.string();break;case 2:n.userId=t.uint32();break;default:t.skipType(7&i)}}return n},e.decodeDelimited=function(t){return t instanceof $Reader||(t=new $Reader(t)),this.decode(t,t.uint32())},e.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.account&&t.hasOwnProperty("account")&&!$util.isString(t.account)?"account: string expected":null!=t.userId&&t.hasOwnProperty("userId")&&!$util.isInteger(t.userId)?"userId: integer expected":null},e.fromObject=function(t){if(t instanceof $root.room.JoinRoomMessage)return t;var e=new $root.room.JoinRoomMessage;return null!=t.account&&(e.account=String(t.account)),null!=t.userId&&(e.userId=t.userId>>>0),e},e.toObject=function(t,e){e||(e={});var r={};return e.defaults&&(r.account="",r.userId=0),null!=t.account&&t.hasOwnProperty("account")&&(r.account=t.account),null!=t.userId&&t.hasOwnProperty("userId")&&(r.userId=t.userId),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),$g.LeaveRoomMessage=function(){function e(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return e.prototype.account="",e.prototype.userId=0,e.create=function(t){return new e(t)},e.encode=function(t,e){return e||(e=$Writer.create()),null!=t.account&&t.hasOwnProperty("account")&&e.uint32(10).string(t.account),null!=t.userId&&t.hasOwnProperty("userId")&&e.uint32(16).uint32(t.userId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){t instanceof $Reader||(t=$Reader.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new $root.room.LeaveRoomMessage;t.pos<r;){var i=t.uint32();switch(i>>>3){case 1:n.account=t.string();break;case 2:n.userId=t.uint32();break;default:t.skipType(7&i)}}return n},e.decodeDelimited=function(t){return t instanceof $Reader||(t=new $Reader(t)),this.decode(t,t.uint32())},e.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.account&&t.hasOwnProperty("account")&&!$util.isString(t.account)?"account: string expected":null!=t.userId&&t.hasOwnProperty("userId")&&!$util.isInteger(t.userId)?"userId: integer expected":null},e.fromObject=function(t){if(t instanceof $root.room.LeaveRoomMessage)return t;var e=new $root.room.LeaveRoomMessage;return null!=t.account&&(e.account=String(t.account)),null!=t.userId&&(e.userId=t.userId>>>0),e},e.toObject=function(t,e){e||(e={});var r={};return e.defaults&&(r.account="",r.userId=0),null!=t.account&&t.hasOwnProperty("account")&&(r.account=t.account),null!=t.userId&&t.hasOwnProperty("userId")&&(r.userId=t.userId),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),$g),$root.test=(fi={},fi.TestMessage=function(){function e(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return e.prototype.test_field="",e.create=function(t){return new e(t)},e.encode=function(t,e){return e||(e=$Writer.create()),null!=t.test_field&&t.hasOwnProperty("test_field")&&e.uint32(10).string(t.test_field),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){t instanceof $Reader||(t=$Reader.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new $root.test.TestMessage;t.pos<r;){var i=t.uint32();switch(i>>>3){case 1:n.test_field=t.string();break;default:t.skipType(7&i)}}return n},e.decodeDelimited=function(t){return t instanceof $Reader||(t=new $Reader(t)),this.decode(t,t.uint32())},e.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.test_field&&t.hasOwnProperty("test_field")&&!$util.isString(t.test_field)?"test_field: string expected":null},e.fromObject=function(t){if(t instanceof $root.test.TestMessage)return t;var e=new $root.test.TestMessage;return null!=t.test_field&&(e.test_field=String(t.test_field)),e},e.toObject=function(t,e){e||(e={});var r={};return e.defaults&&(r.test_field=""),null!=t.test_field&&t.hasOwnProperty("test_field")&&(r.test_field=t.test_field),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),fi),$root.test2=(Ki={},Ki.Test2Message=function(){function e(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return e.prototype.test2_field="",e.create=function(t){return new e(t)},e.encode=function(t,e){return e||(e=$Writer.create()),null!=t.test2_field&&t.hasOwnProperty("test2_field")&&e.uint32(10).string(t.test2_field),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){t instanceof $Reader||(t=$Reader.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new $root.test2.Test2Message;t.pos<r;){var i=t.uint32();switch(i>>>3){case 1:n.test2_field=t.string();break;default:t.skipType(7&i)}}return n},e.decodeDelimited=function(t){return t instanceof $Reader||(t=new $Reader(t)),this.decode(t,t.uint32())},e.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.test2_field&&t.hasOwnProperty("test2_field")&&!$util.isString(t.test2_field)?"test2_field: string expected":null},e.fromObject=function(t){if(t instanceof $root.test2.Test2Message)return t;var e=new $root.test2.Test2Message;return null!=t.test2_field&&(e.test2_field=String(t.test2_field)),e},e.toObject=function(t,e){e||(e={});var r={};return e.defaults&&(r.test2_field=""),null!=t.test2_field&&t.hasOwnProperty("test2_field")&&(r.test2_field=t.test2_field),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),Ki),$root.whiteboard=(nj={},nj.CommandMessage=function(){function e(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return e.prototype.command="",e.create=function(t){return new e(t)},e.encode=function(t,e){return e||(e=$Writer.create()),null!=t.command&&t.hasOwnProperty("command")&&e.uint32(10).string(t.command),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){t instanceof $Reader||(t=$Reader.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new $root.whiteboard.CommandMessage;t.pos<r;){var i=t.uint32();switch(i>>>3){case 1:n.command=t.string();break;default:t.skipType(7&i)}}return n},e.decodeDelimited=function(t){return t instanceof $Reader||(t=new $Reader(t)),this.decode(t,t.uint32())},e.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.command&&t.hasOwnProperty("command")&&!$util.isString(t.command)?"command: string expected":null},e.fromObject=function(t){if(t instanceof $root.whiteboard.CommandMessage)return t;var e=new $root.whiteboard.CommandMessage;return null!=t.command&&(e.command=String(t.command)),e},e.toObject=function(t,e){e||(e={});var r={};return e.defaults&&(r.command=""),null!=t.command&&t.hasOwnProperty("command")&&(r.command=t.command),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),nj);var protocols=$root,protolist=createCommonjsModule(function(t,e){var r;Object.defineProperty(e,"__esModule",{value:!0}),(r=e.MsgType||(e.MsgType={}))[r.room_JoinRoomMessage=1e4]="room_JoinRoomMessage",r[r.room_LeaveRoomMessage=10001]="room_LeaveRoomMessage",r[r.test_TestMessage=10002]="test_TestMessage",r[r.test2_Test2Message=10003]="test2_Test2Message",r[r.whiteboard_CommandMessage=10004]="whiteboard_CommandMessage";var n={1e4:protocols.room.JoinRoomMessage,10001:protocols.room.LeaveRoomMessage,10002:protocols.test.TestMessage,10003:protocols.test2.Test2Message,10004:protocols.whiteboard.CommandMessage};e.msgMap=n});unwrapExports(protolist);var protolist_1=protolist.MsgType,protolist_2=protolist.msgMap,protoutils=createCommonjsModule(function(t,e){function o(t,e){var r=t[e]<<24;return r+=t[e+1]<<16,r+=t[e+2]<<8,r+=t[e+3]}function i(t,e,r){t[e]=r>>24&255,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function n(t){this._buffer=t||null}return n.create=function(t,e){var r=new n;return r.encode(t,e),r},Object.defineProperty(n.prototype,"buffer",{get:function(){return this._buffer},enumerable:!0,configurable:!0}),n.prototype.getMsgData=function(){if(!this._buffer||this._buffer.byteLength<8)return null;var t=o(this._buffer,0);if(this._buffer.byteLength<t+4)return null;var e=o(this._buffer,4),r={type:e};if(8<this._buffer.byteLength){var n=protolist.msgMap[e],i=n.decode(this._buffer.subarray(8,t+4));i&&(r.data=n.toObject(i))}return r},n.prototype.encode=function(t,e){var r=protolist.msgMap[t].encode(e).finish();this._buffer=new Uint8Array(8+r.length),i(this._buffer,0,r.length+4),i(this._buffer,4,t),this._buffer.set(r,8)},n}();e.Packet=r;var n=function(){function t(){this.BUFFER_INCR_SIZE=1024,this._buffer=new Uint8Array(this.BUFFER_INCR_SIZE),this._offset=0,this._length=0,this._messages=[]}return t.prototype.put=function(t){if(this._buffer.byteLength-this._offset-this._length>=t.byteLength)this._buffer.set(t,this._offset+this._length);else if(this._buffer.byteLength-this._length>=t.byteLength)this._buffer.copyWithin(0,this._offset,this._offset+this._length),this._offset=0,this._buffer.set(t,this._length);else{for(var e=this._buffer.byteLength;e-this._length<t.byteLength;)e+=this.BUFFER_INCR_SIZE;var r=new Uint8Array(e);r.set(this._buffer.subarray(this._offset,this._offset+this._length),0),r.set(t,this._length),this._buffer=r,this._offset=0}for(this._length+=t.byteLength;;){var n=this._get();if(!n)break;this._messages.push(n)}},t.prototype.getMessage=function(){return this._messages.shift()||null},t.prototype._get=function(){if(this._length<4)return null;var t=o(this._buffer,this._offset);if(!t)return null;if(t+=4,this._length<t)return null;var e=this._buffer.subarray(this._offset,this._offset+t);return this._offset+=t,this._length-=t,new r(e).getMsgData()},t}();e.MessageAssembler=n});unwrapExports(protoutils);var protoutils_1=protoutils.Packet,protoutils_2=protoutils.MessageAssembler,prototest=createCommonjsModule(function(t,e){var r,n,i;Object.defineProperty(e,"__esModule",{value:!0}),r=protoutils.Packet.create(protolist.MsgType.test_TestMessage,{testField:"hello"}),n=protoutils.Packet.create(protolist.MsgType.test2_Test2Message,{test2Field:"hello2"}),(i=new protoutils.MessageAssembler).put(r.buffer),i.put(n.buffer),console.log(i.getMessage()),console.log(i.getMessage())}),prototest$1=unwrapExports(prototest);exports.default=prototest$1,Object.defineProperty(exports,"__esModule",{value:!0})});
